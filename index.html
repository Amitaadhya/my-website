<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amit Chaudhary | Radnik Hub</title>
  <link rel="icon" href="https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png" type="image/png">
  
  <!-- Fonts: 'Space Grotesk' for Headings, 'Inter' for reading -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&family=Space+Grotesk:wght@500;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  
  <style>
    :root {
      /* --- THEME COLORS (Cyber Blue & Deep Dark) --- */
      --bg-dark: #030712;       /* Almost Black */
      --bg-card: #111827;       /* Dark Gray Blue */
      --accent: #06b6d4;        /* Cyan Neon */
      --accent-glow: rgba(6, 182, 212, 0.3);
      --text-main: #f3f4f6;
      --text-muted: #9ca3af;
      
      /* Glass Effect Variables */
      --glass-bg: rgba(17, 24, 39, 0.7);
      --glass-border: rgba(255, 255, 255, 0.08);
      --sidebar-width: 280px;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', sans-serif;
      background-color: var(--bg-dark);
      color: var(--text-main);
      overflow-x: hidden;
      height: 100vh;
      background-image: 
        radial-gradient(circle at 15% 50%, rgba(6, 182, 212, 0.08), transparent 25%), 
        radial-gradient(circle at 85% 30%, rgba(124, 58, 237, 0.08), transparent 25%);
    }

    /* --- SCROLLBAR --- */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: #374151; border-radius: 10px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--accent); }

    /* --- PRELOADER --- */
    #preloader {
      position: fixed; inset: 0; background: var(--bg-dark); z-index: 9999;
      display: flex; justify-content: center; align-items: center;
      transition: 0.5s;
    }
    #preloader.hidden { opacity: 0; pointer-events: none; }
    .loader {
      width: 50px; height: 50px;
      border: 3px solid rgba(255,255,255,0.1);
      border-radius: 50%; border-top-color: var(--accent);
      animation: spin 1s ease-in-out infinite;
      box-shadow: 0 0 20px var(--accent-glow);
    }
    @keyframes spin { to { transform: rotate(360deg); } }

    /* --- LOGIN SCREEN (Futuristic) --- */
    .login-container {
      position: fixed; inset: 0; z-index: 2000;
      display: flex; justify-content: center; align-items: center;
      background: rgba(3, 7, 18, 0.6);
      backdrop-filter: blur(15px);
      transition: 0.5s;
    }
    .login-container.hidden { opacity: 0; visibility: hidden; transform: scale(0.95); }

    .login-box {
      width: 100%; max-width: 420px;
      padding: 40px;
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      border-radius: 24px;
      box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      text-align: center;
      position: relative;
      overflow: hidden;
    }
    
    /* Top glowing line */
    .login-box::after {
      content: ''; position: absolute; top: 0; left: 0; width: 100%; height: 2px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
    }

    .logo-glow {
      width: 90px; height: 90px; margin: 0 auto 20px;
      border-radius: 50%; padding: 4px;
      background: linear-gradient(135deg, var(--bg-card), #1f2937);
      box-shadow: 0 0 30px rgba(6, 182, 212, 0.2);
      border: 1px solid var(--glass-border);
    }
    .logo-glow img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }

    .login-box h1 { font-family: 'Space Grotesk', sans-serif; font-size: 2rem; margin-bottom: 5px; }
    .login-box p { color: var(--text-muted); font-size: 0.9rem; margin-bottom: 30px; }

    .input-field {
      position: relative; margin-bottom: 16px;
    }
    .input-field i {
      position: absolute; left: 16px; top: 50%; transform: translateY(-50%);
      color: var(--text-muted); transition: 0.3s;
    }
    .input-field input {
      width: 100%; padding: 16px 16px 16px 45px;
      background: rgba(0,0,0,0.3);
      border: 1px solid #374151;
      border-radius: 12px;
      color: white; font-size: 1rem;
      transition: 0.3s;
    }
    .input-field input:focus {
      outline: none; border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-glow);
      background: rgba(0,0,0,0.5);
    }
    .input-field input:focus + i { color: var(--accent); }

    .btn-primary {
      width: 100%; padding: 16px;
      background: var(--accent);
      color: #000; font-weight: 700;
      border: none; border-radius: 12px;
      cursor: pointer; font-size: 1rem;
      transition: 0.3s; text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: 0 10px 20px -5px var(--accent-glow);
    }
    .btn-primary:hover {
      background: #22d3ee; transform: translateY(-2px);
      box-shadow: 0 15px 25px -5px var(--accent-glow);
    }

    /* --- MAIN LAYOUT --- */
    .portal-view {
      display: flex; height: 100vh; overflow: hidden;
      opacity: 0; pointer-events: none; transition: 0.5s;
    }
    .portal-view.visible { opacity: 1; pointer-events: auto; }

    /* --- SIDEBAR --- */
    .sidebar {
      width: var(--sidebar-width); height: 100%;
      background: var(--bg-card);
      border-right: 1px solid var(--glass-border);
      display: flex; flex-direction: column;
      padding: 24px; z-index: 100;
      transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .brand-logo {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 40px; padding-left: 10px;
    }
    .brand-logo i { font-size: 1.5rem; color: var(--accent); }
    .brand-logo span { font-family: 'Space Grotesk', sans-serif; font-size: 1.25rem; font-weight: 700; }

    .nav-links { flex: 1; list-style: none; display: flex; flex-direction: column; gap: 8px; }
    .nav-item a {
      display: flex; align-items: center; gap: 14px;
      padding: 14px 16px; border-radius: 12px;
      color: var(--text-muted); text-decoration: none;
      font-weight: 500; transition: 0.2s;
    }
    .nav-item a:hover {
      background: rgba(255,255,255,0.03); color: white;
    }
    .nav-item a.active {
      background: linear-gradient(90deg, rgba(6, 182, 212, 0.15), transparent);
      color: var(--accent); border-left: 3px solid var(--accent);
    }
    .nav-item i { width: 20px; text-align: center; }

    .user-panel {
      padding: 16px; background: rgba(0,0,0,0.2);
      border-radius: 16px; display: flex; align-items: center; gap: 12px;
      border: 1px solid var(--glass-border);
    }
    .user-panel img { width: 40px; height: 40px; border-radius: 50%; object-fit: cover; }
    .user-details h4 { font-size: 0.9rem; margin-bottom: 2px; }
    .logout-btn { font-size: 0.75rem; color: #ef4444; cursor: pointer; text-decoration: none; }

    /* --- MAIN CONTENT --- */
    .main-content {
      flex: 1; height: 100%; overflow-y: auto;
      padding: 30px 40px; position: relative;
    }

    .header-bar {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 40px;
    }
    .welcome-section h2 { font-family: 'Space Grotesk', sans-serif; font-size: 2rem; }
    .welcome-section p { color: var(--text-muted); }
    
    .clock-badge {
      background: rgba(6, 182, 212, 0.1); color: var(--accent);
      padding: 8px 16px; border-radius: 30px; border: 1px solid rgba(6, 182, 212, 0.2);
      font-family: 'Space Grotesk', monospace; font-weight: 600;
    }

    /* --- SEARCH BAR --- */
    .toolbar {
      display: flex; gap: 15px; margin-bottom: 30px;
      background: var(--bg-card); padding: 10px;
      border-radius: 16px; border: 1px solid var(--glass-border);
    }
    .search-wrap { flex: 1; position: relative; }
    .search-wrap input {
      width: 100%; padding: 14px 14px 14px 45px;
      background: transparent; border: none;
      color: white; font-size: 1rem;
    }
    .search-wrap input:focus { outline: none; }
    .search-wrap i { position: absolute; left: 18px; top: 50%; transform: translateY(-50%); color: var(--text-muted); }
    
    .category-select {
      background: #1f2937; color: white; border: none;
      padding: 0 24px; border-radius: 10px; cursor: pointer;
      outline: none; font-family: 'Inter', sans-serif;
    }

    /* --- BUTTONS GRID (The Hero) --- */
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
      gap: 24px; padding-bottom: 60px;
    }

    .tool-card {
      position: relative;
      background: linear-gradient(145deg, #1f2937, #111827);
      padding: 24px; border-radius: 20px;
      text-decoration: none; color: white;
      border: 1px solid var(--glass-border);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex; flex-direction: column;
      justify-content: space-between;
      height: 160px; overflow: hidden;
    }
    
    /* Card Hover Effect */
    .tool-card:hover {
      transform: translateY(-8px) scale(1.02);
      border-color: var(--accent);
      box-shadow: 0 20px 40px -10px rgba(0,0,0,0.5);
    }
    
    /* Glow behind icon */
    .icon-box {
      width: 50px; height: 50px;
      background: rgba(255,255,255,0.05);
      border-radius: 14px;
      display: flex; justify-content: center; align-items: center;
      font-size: 1.5rem; color: var(--accent);
      margin-bottom: 15px; transition: 0.3s;
    }
    .tool-card:hover .icon-box {
      background: var(--accent); color: #000;
      transform: rotate(-10deg);
    }
    
    .card-text h3 { font-size: 1.1rem; font-weight: 600; line-height: 1.4; margin-bottom: 4px; }
    .card-text p { font-size: 0.8rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px; }
    
    .arrow-icon {
      position: absolute; bottom: 24px; right: 24px;
      opacity: 0; transform: translateX(-10px); transition: 0.3s;
      color: var(--accent);
    }
    .tool-card:hover .arrow-icon { opacity: 1; transform: translateX(0); }

    /* --- MODALS --- */
    .modal {
      display: none; position: fixed; inset: 0; z-index: 3000;
      background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
    }
    .modal-content {
      background: var(--bg-card);
      border: 1px solid var(--glass-border);
      width: 95%; max-width: 650px;
      margin: 80px auto; padding: 30px;
      border-radius: 24px;
      box-shadow: 0 25px 50px rgba(0,0,0,0.7);
      animation: modalSlide 0.3s ease-out;
    }
    @keyframes modalSlide { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    
    .modal-header { display: flex; justify-content: space-between; margin-bottom: 25px; border-bottom: 1px solid var(--glass-border); padding-bottom: 15px; }
    .close-btn { font-size: 1.8rem; cursor: pointer; color: var(--text-muted); }
    .close-btn:hover { color: #ef4444; }
    
    textarea, select { width: 100%; background: #030712; border: 1px solid #374151; color: white; padding: 15px; border-radius: 12px; font-family: 'Inter'; outline: none; }
    textarea:focus { border-color: var(--accent); }

    /* Mobile */
    #menuToggle { display: none; background: none; border: none; color: white; font-size: 1.5rem; cursor: pointer; margin-right: 15px; }
    
    @media (max-width: 992px) {
      .sidebar { position: fixed; left: -100%; width: 100%; max-width: 300px; }
      .sidebar.open { left: 0; box-shadow: 50px 0 100px rgba(0,0,0,0.5); }
      #menuToggle { display: block; }
      .main-content { padding: 20px; }
      .header-bar { flex-direction: column; align-items: flex-start; gap: 15px; }
      .toolbar { flex-direction: column; }
    }
  </style>
</head>
<body>

  <!-- LOADING SPINNER -->
  <div id="preloader"><div class="loader"></div></div>

  <!-- LOGIN PAGE -->
  <div class="login-container" id="loginContainer">
    <div class="login-box">
      <div class="logo-glow">
        <img src="https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png" alt="Logo">
      </div>
      <h1>Amit Chaudhary</h1>
      <p>Amit Chaudhary | Secure Login</p>
      
      <div style="margin-top: 30px;">
        <div class="input-field">
          <input type="text" id="username" placeholder="Username">
          <i class="fas fa-user"></i>
        </div>
        <div class="input-field">
          <input type="password" id="password" placeholder="Password">
          <i class="fas fa-lock"></i>
        </div>
        
        <button class="btn-primary" id="loginBtn">Enter Dashboard</button>
        <p id="errorMessage" style="color: #ef4444; margin-top: 15px; font-size: 0.85rem; display: none;"></p>
      </div>
    </div>
  </div>

  <!-- MAIN DASHBOARD -->
  <div class="portal-view" id="portalView">
    
    <!-- Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div class="brand-logo">
        <i class="fas fa-cube"></i>
        <span>Amit Chaudhary</span>
      </div>
      
      <ul class="nav-links">
        <li class="nav-item"><a id="dashboardLink" class="active"><i class="fas fa-th-large"></i> Dashboard</a></li>
        <li class="nav-item"><a id="myProfileBtnSidebar"><i class="fas fa-user-astronaut"></i> Profile</a></li>
        <li class="nav-item"><a id="notepadBtnSidebar"><i class="fas fa-sticky-note"></i> Notes</a></li>
        <li class="nav-item admin-only" style="display:none;"><a id="userManagementBtnSidebar"><i class="fas fa-users-cog"></i> Users</a></li>
        <li class="nav-item admin-only" style="display:none;"><a id="portalSettingsBtnSidebar"><i class="fas fa-sliders-h"></i> Settings</a></li>
      </ul>
      
      <div style="margin-top: auto;">
        <div class="user-panel" id="userProfile" style="display:none;">
          <img id="userProfilePic" src="" alt="User">
          <div class="user-details">
            <h4 id="userNameText">User</h4>
            <a id="logoutLink" class="logout-btn">Log out <i class="fas fa-sign-out-alt"></i></a>
          </div>
        </div>
      </div>
    </nav>

    <!-- Content -->
    <main class="main-content" id="mainContent">
      <header class="header-bar" id="mainHeader">
        <div style="display:flex; align-items:center;">
          <button id="menuToggle"><i class="fas fa-bars"></i></button>
          <div class="welcome-section">
            <h2 id="welcomeMessage">Welcome</h2>
            <p>Here is your mission control center.</p>
          </div>
        </div>
        <div class="clock-badge" id="clock">00:00</div>
      </header>
      
      <!-- Search Toolbar -->
      <div class="toolbar">
        <div class="search-wrap">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search for tools, sheets, or data...">
        </div>
        <select class="category-select" id="categoryFilter">
          <option value="all">All Categories</option>
        </select>
      </div>
      
      <!-- The Grid -->
      <div class="grid-container" id="buttonContainer">
        <!-- Cards injected via JS -->
      </div>
    </main>
  </div>
  
  <!-- MODALS -->
  <div id="userProfileModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>My Profile</h2><span class="close-btn">&times;</span></div><p>Profile features coming soon.</p></div></div>
  <div id="notepadModal" class="modal"><div class="modal-content"><div class="modal-header"><h2><i class="fas fa-pen"></i> Notepad</h2><span class="close-btn">&times;</span></div><textarea id="notepadTextarea" rows="10" placeholder="Type your notes here..."></textarea><button class="btn-primary" id="saveNotepadBtn" style="margin-top:15px;">Save Notes</button></div></div>
  <div id="userManagementModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>User Management</h2><span class="close-btn">&times;</span></div><div id="userManagementMessage" style="text-align:center; margin-bottom:10px;"></div><div style="display:grid; grid-template-columns: 1fr 1fr; gap:20px;"><div><h3>Add User</h3><input id="newUsername" class="input-field" placeholder="Username" style="margin:10px 0; width:100%; background:#1f2937; border:1px solid #374151; padding:10px; color:white;"><input id="newPassword" type="password" placeholder="Password" style="margin-bottom:10px; width:100%; background:#1f2937; border:1px solid #374151; padding:10px; color:white;"><button class="btn-primary" id="createUserBtn">Create</button></div><div><h3>Permissions</h3><select id="selectUserForPermissions" style="margin-bottom:10px;"><option>Select User</option></select><div id="permissionsContainer" style="display:none;"><div id="permissionsList" style="height:150px; overflow-y:auto; background:#030712; padding:10px; border-radius:8px;"></div><button class="btn-primary" id="savePermissionsBtn" style="margin-top:10px; padding:10px;">Save</button><button id="deleteUserBtn" style="background:#ef4444; color:white; border:none; padding:10px; border-radius:10px; margin-top:5px; width:100%; cursor:pointer;">Delete User</button></div></div></div></div></div>
  <div id="portalSettingsModal" class="modal"><div class="modal-content"><div class="modal-header"><h2>Settings</h2><span class="close-btn">&times;</span></div><p>Settings coming soon.</p></div></div>

  <!-- JAVASCRIPT (Exactly preserved) -->
  <script>
    // --- STARTUP LOGIC ---
    document.addEventListener('DOMContentLoaded', () => {
        initializeApp();
    });

    // --- STATE & CONSTANTS ---
    const USERS_KEY = 'radnikPortalUsers_v10';
    const PERMISSIONS_KEY = 'radnikPortalPermissions_v10';
    let currentUser = null;
    let allButtons = [];
    let filteredButtons = [];

    // --- BUTTON DATA (Centralized) ---
    const ALL_BUTTONS_DATA = [
      { id: "noida-tax-invoice", href: "https://docs.google.com/spreadsheets/d/1p1LreGjZFEWSY3qfkbGaWGymDa_3kzwucDH3xHoPzqU/edit", icon: "fas fa-file-invoice-dollar", text: "Noida Tax Invoice Log", category: "Finance" },
      { id: "186-tax-invoice", href: "https://docs.google.com/spreadsheets/d/1clgoSGc3BF6u25v-cumlJMqrCOZYSydWJ_xSAOpe0FE/edit", icon: "fas fa-receipt", text: "186 Tax Invoice Log", category: "Finance" },
      { id: "eway-bill", href: "https://192.168.20.7/vgeinvoice/LoginPage.aspx", icon: "fas fa-truck-fast", text: "E-Way Bill Dashboard", category: "Logistics" },
      { id: "merge-pdf", href: "https://smallpdf.com/merge-pdf", icon: "fas fa-file-pdf", text: "Merge PDF", category: "Tools" },
      { id: "app-365", href: "https://www.office.com/apps/?auth=2", icon: "fab fa-microsoft", text: "Office 365 Apps", category: "Tools" },
      { id: "chargeback-form", href: "https://docs.google.com/forms/d/e/1FAIpQLSfQf5LaxGX8lLr4nN7hPmrL3mpuaFv1uzYMTaIb02IcGFHp5g/viewform", icon: "fas fa-undo-alt", text: "Chargeback Form", category: "Finance" },
      { id: "daily-sale-186", href: "https://radnikexports1-my.sharepoint.com/:x:/r/personal/amit_chaudhary_radnikexports1_onmicrosoft_com/_layouts/15/Doc.aspx?sourcedoc=%7B5DE750E6-1A38-4B42-B02D-44A3D95B2D14%7D&file=Book%206.xlsx&action=editnew", icon: "fas fa-calendar-day", text: "Daily Sale 186", category: "Sales" },
      { id: "dsec16-sale", href: "https://radnikexports1-my.sharepoint.com/:x:/r/personal/amit_chaudhary_radnikexports1_onmicrosoft_com/_layouts/15/Doc.aspx?sourcedoc=%7B866121D0-C91C-4F09-9F0B-909FBB0C2324%7D&file=DAILY%20SALE%20ENTERY%20NOIDA.xlsx&action=default", icon: "fas fa-cash-register", text: "D-S-E-C16 (Noida Sale)", category: "Sales" },
      { id: "noida-order-entry", href: "https://docs.google.com/spreadsheets/d/11RCeL6pUqN8khww5sY_iA_t-mNgrzwQNvV-bRtLKA9s/edit", icon: "fas fa-clipboard-check", text: "Noida Order Entry", category: "Sales" },
      { id: "chargeback-data", href: "https://docs.google.com/spreadsheets/d/1V92jsBq9iTbYnaoaIdmYdbYc9uoFvaimxaYScnHLD7w/edit", icon: "fas fa-hand-holding-usd", text: "Chargeback Data", category: "Finance" },
      { id: "live-graph-quince", href: "https://docs.google.com/spreadsheets/d/17XLwAmZxvmxOaB-DzPIBjuGmb3u_Zxz9_1aGn175yeE/edit", icon: "fas fa-chart-line", text: "Live Graph Quince", category: "Analytics" },
      { id: "quince-2024-sale", href: "https://docs.google.com/spreadsheets/d/1c4VbDj3CCp_Lr2MCpoJXmlp2K9qP6L3pIA0eZq52PDM/edit", icon: "fas fa-database", text: "QUINCE 2024 SALE DATA", category: "Sales" },
      { id: "maersk-stock-data", href: "https://docs.google.com/spreadsheets/d/1sehWq-1kvNwl0qZWOpkhapuk9mam0FjKAoJvHMV9U5o/edit", icon: "fas fa-ship", text: "MAERSK Stock Data", category: "Logistics" },
      { id: "quince-2025-pos", href: "https://docs.google.com/spreadsheets/d/17RWCZ62o2nRvMgZjfi_fZ6AyBQ0YmHNoIp-CCRSxJjg/edit", icon: "fas fa-shopping-cart", text: "QUINCE 2025 POS DATA", category: "Sales" },
      { id: "quince-invoice-summary", href: "https://docs.google.com/spreadsheets/d/1PnetSLtEPxot9N3KlB_ydbzNccAF5qMnDMRmYLo6ZLs/edit", icon: "fas fa-file-invoice", text: "Quince Invoice Summary", category: "Finance" },
      { id: "ggn-sales-overview", href: "https://docs.google.com/spreadsheets/d/1riS3U9aPW7s8SQmqaZkGrb2fHVEdDbJdHxwdygaeKXc/edit", icon: "fas fa-city", text: "Gurugram Sales Overview", category: "Sales" },
      { id: "noida-sales-overview", href: "https://docs.google.com/spreadsheets/d/15Xma9DRkRectWPqUKDQlr5yZQMtCfQ2Bxa_J5vU-Es0/edit", icon: "fas fa-building-user", text: "Noida Sales Overview", category: "Sales" },
      { id: "anish-sir-site", href: "https://sites.google.com/view/bossanishji/", icon: "fas fa-user-tie", text: "Anish Sir's Site", category: "Resources" },
      { id: "amit-chaudhary-site", href: "https://sites.google.com/view/radnikaks/home", icon: "fas fa-user-astronaut", text: "Amit Chaudhary's Site", category: "Resources" },
      { id: "186-qs-view", href: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_ihmuGBmPjY_SF6zXQe825cL0i3O9FjTod0gVVgjvc9uSU1HrQsSxcGSVRLAUrJA8NjruJPKs7ezi/pubhtml", icon: "fas fa-chart-pie", text: "186-Q-S-VIEW", category: "Analytics" },
      { id: "c16-qs-view", href: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1MRNcqWJsXyp4gKAq00N2qKmjoNgXkwVCmxH2lBeeitlz0kNfSiY-z1sNK2JTciPN6mzUpF9-G36Z/pubhtml", icon: "fas fa-chart-area", text: "C16-Q-S-VIEW", category: "Analytics" },
      { id: "c16-import-details", href: "https://docs.google.com/spreadsheets/d/1m3q0x9wKoM7Q7EBSCvpCTozbtB0-73xmgOO_Yx0EBAg/edit", icon: "fas fa-file-import", text: "C16-IMPORT DETAILS", category: "Logistics" },
      { id: "ggn-prep-2025", href: "https://docs.google.com/spreadsheets/d/1LZa3JvfEdt-9cdQkEmsEluwurMoDzmsXIyFWNpAcnfs/edit", icon: "fas fa-tasks", text: "GGN-PREPEMENT 2025", category: "Operations" },
      { id: "quince-hk", href: "https://docs.google.com/spreadsheets/d/1l2CnQrl9YEfOFAoiqj82DYwJ-zQWYqCX5HuL87ffRlw/edit", icon: "fas fa-globe-asia", text: "Quince Hong Kong", category: "International" },
      { id: "projection-vs-sales", href: "https://docs.google.com/spreadsheets/d/1QzAuxxuLUz60iWbdiVGzAFDjXY0RSZIda_0VOhbloEU/edit", icon: "fas fa-bullseye", text: "Projection VS Sales Report", category: "Analytics" },
      { id: "quince-order-chart", href: "https://docs.google.com/spreadsheets/d/1JFI22zsy2Pa5d2lq4dcEeCZIg7rqFaBMYPzniBdlhMc/edit", icon: "fas fa-list-ol", text: "QUINCE ORDER CHART", category: "Sales" },
      { id: "projection-vs-actual", href: "https://docs.google.com/spreadsheets/d/1f7bODkOgwvN_i-nWItzn_67IZv0EqXxAqr2v-ZRQ8Vg/edit", icon: "fas fa-project-diagram", text: "PROJECTION VS ACTUAL", category: "Analytics" },
      { id: "quince-sale-hub", href: "https://docs.google.com/spreadsheets/d/1_5-nGWZmyI5WkTSp6muKe7uEhel7DoAzX1oisoBz1Xw/edit", icon: "fas fa-sitemap", text: "Quince Sale All Data Hub", category: "Sales" },
      { id: "po-wise-qty", href: "https://docs.google.com/spreadsheets/d/1bQqiCaiQ_JGN_B-415ftvVgoH9MmaF9A4ydZkkYXS-Q/edit", icon: "fas fa-exchange-alt", text: "PO Wise Qty Send/Sale", category: "Operations" },
      { id: "sales-perf-ggn", href: "https://amitaadhya.github.io/Quincesaleggn/", icon: "fas fa-tachometer-alt", text: "Sales Perf. Dashboard-GGN", category: "Analytics" },
      { id: "sales-perf-noida", href: "https://amitaadhya.github.io/noidaquincesale/", icon: "fas fa-chart-bar", text: "NOIDA-Sales Perf. Dash.", category: "Analytics" },
      { id: "quince-style-value", href: "https://docs.google.com/spreadsheets/d/1GQucVQMxZanFgg27PGDpflR49a6DksezH4Pby2uFu4A/edit", icon: "fas fa-dollar-sign", text: "QUINCE Style Name Wise Value", category: "Analytics" },
      { id: "quince-invoice-summary-2", href: "https://docs.google.com/spreadsheets/d/1PnetSLtEPxot9N3KlB_ydbzNccAF5qMnDMRmYLo6ZLs/edit", icon: "fas fa-file-alt", text: "Quince_Invoice Summary", category: "Finance" },
      { id: "style-analyzer-ggn", href: "https://script.google.com/macros/s/AKfycbwMLk_TuKGtxzLFMxIoLVONqYMS5RRCf3cBqS9zDw/dev", icon: "fas fa-search-dollar", text: "Quince_ Style Analyzer_GGN", category: "Analytics" },
      { id: "style-analyzer-noida", href: "https://script.google.com/macros/s/AKfycbzljj_8OxdNR2AtJqxfTD_oB11YGTdF0MGulyLCvpE/dev", icon: "fas fa-search-location", text: "Quince_ Style Analyzer_NOIDA", category: "Analytics" },
      { id: "quince-shipping-data", href: "https://docs.google.com/spreadsheets/d/1EfFlN6kb_q08R3cWQT_LJfRoSCKvGpS_JkJGZaUMA34/edit", icon: "fas fa-globe-americas", text: "Quince Mexcio & Canada Ship Data", category: "International" },
      { id: "useful-websites", href: "https://www.notion.so/Welcome-to-Amit-Chaudhary-22a7a00d4f9780fe8865e67bf16d2430", icon: "fas fa-star", text: "Most Useful Websites (AKS!)", category: "Resources" },
      { id: "ggn-revenue-chargeback", href: "https://script.google.com/macros/s/AKfycbw6qke8xOhYaqaxcjFOgp-_wtWAwXEAfVqJA8e6-A/dev", icon: "fas fa-file-excel", text: "GGN Revenue & Chargeback Summary", category: "Finance" },
      { id: "noida-revenue-chargeback", href: "https://script.google.com/macros/s/AKfycbw1Dpw--Ar3rNg3IgPn3e32gpUODmv_O12053XHUYc/dev", icon: "far fa-file-excel", text: "NOIDA Revenue & Chargeback Summary", category: "Finance" },
      { id: "payment-management", href: "https://script.google.com/macros/s/AKfycbwEj1e1d0DfYqaTPbDarQTTYiMaiRWOodd5Cu6x4Sc/dev", icon: "fas fa-credit-card", text: "Radnik Q Payment Management", category: "Finance" },
      { id: "quince-po-records", href: "https://docs.google.com/spreadsheets/d/1pcb48pdm_kwASlmRACu1_E3s1_DHcofF5uOx6h4mLXY/edit", icon: "fas fa-archive", text: "QUINCE PO RECORDS", category: "Operations" },
      { id: "ggn-quince-po-records", href: "https://docs.google.com/spreadsheets/d/1SA8SPgEQJzf-oCBDs6vbIcHdfau12cAoms5hsAANRAA/edit?gid=0#gid=0", icon: "fas fa-archive", text: "GGN QUINCE PO RECORDS", category: "Operations" },
      { id: "noida-quince-po-records", href: "https://docs.google.com/spreadsheets/d/1Gt6pzKGkboWUK-Ijbp5OeFjYuvq_JD22xip_D4cDYxg/edit?gid=0#gid=0", icon: "fas fa-archive", text: "NOIDA QUINCE PO RECORDS", category: "Operations" },
    ];
    
    // --- UTILITY FUNCTIONS ---
    const getFromLocalStorage = (key, def) => { try { return JSON.parse(localStorage.getItem(key)) || def; } catch { return def; } };
    const saveToLocalStorage = (key, data) => localStorage.setItem(key, JSON.stringify(data));
    const simpleHash = s => { if(!s) return ""; let h = 0; for(let i=0;i<s.length;i++) h=(h<<5)-h+s.charCodeAt(i)|0; return "h_"+h.toString(36); };

    // --- DOM ELEMENT REFERENCES ---
    const dom = {};
    
    // --- MAIN APP LOGIC ---
    function initializeApp() {
        cacheDOMElements();
        initDefaultUsers();
        initEventListeners();
        updateClock();
        setInterval(updateClock, 30000);

        const savedUserJson = sessionStorage.getItem('currentUser');
        if (savedUserJson) {
            currentUser = JSON.parse(savedUserJson);
            showPortal();
        }

        setTimeout(() => dom.preloader.classList.add('hidden'), 500);
    }
    
    function cacheDOMElements() {
        const ids = ['preloader', 'loginContainer', 'portalView', 'loginBtn', 'username', 'password', 'errorMessage', 'sidebar', 'mainContent', 'menuToggle', 'logoutLink', 'welcomeMessage', 'userProfile', 'userNameText', 'userProfilePic', 'mainHeader', 'buttonContainer', 'myProfileBtnSidebar', 'notepadBtnSidebar', 'userManagementBtnSidebar', 'portalSettingsBtnSidebar', 'userProfileModal', 'notepadModal', 'userManagementModal', 'portalSettingsModal', 'saveNotepadBtn', 'notepadTextarea', 'createUserBtn', 'newUsername', 'newPassword', 'selectUserForPermissions', 'permissionsContainer', 'permissionsList', 'savePermissionsBtn', 'deleteUserBtn', 'userManagementMessage', 'searchInput', 'categoryFilter'];
        ids.forEach(id => dom[id] = document.getElementById(id));
        dom.closeBtns = document.querySelectorAll('.close-btn');
    }

    function initEventListeners() {
        dom.loginBtn.addEventListener('click', validateLogin);
        dom.password.addEventListener('keypress', e => { if (e.key === 'Enter') validateLogin(); });
        dom.logoutLink.addEventListener('click', logout);
        dom.menuToggle.addEventListener('click', () => { dom.sidebar.classList.toggle('open'); });
        
        dom.searchInput.addEventListener('input', filterButtons);
        dom.categoryFilter.addEventListener('change', filterButtons);
        
        dom.myProfileBtnSidebar.addEventListener('click', () => openModal('userProfileModal'));
        dom.notepadBtnSidebar.addEventListener('click', openNotepad);
        dom.userManagementBtnSidebar.addEventListener('click', openUserManagement);
        dom.portalSettingsBtnSidebar.addEventListener('click', () => openModal('portalSettingsModal'));
        dom.closeBtns.forEach(btn => btn.addEventListener('click', (e) => e.target.closest('.modal').style.display = 'none'));
        
        dom.saveNotepadBtn.addEventListener('click', saveNotepad);
        dom.createUserBtn.addEventListener('click', createUser);
        dom.selectUserForPermissions.addEventListener('change', loadPermissionsForUser);
        dom.savePermissionsBtn.addEventListener('click', savePermissions);
        dom.deleteUserBtn.addEventListener('click', deleteUser);
    }
    
    function validateLogin() {
      const username = dom.username.value.trim();
      const password = dom.password.value.trim();
      if (!username || !password) return showLoginMessage('Enter credentials.');

      const users = getFromLocalStorage(USERS_KEY, []);
      const user = users.find(u => u.username.toLowerCase() === username.toLowerCase() && u.password === simpleHash(password));

      if (user) {
        currentUser = user;
        sessionStorage.setItem('currentUser', JSON.stringify(user));
        showPortal();
      } else {
        showLoginMessage('Access Denied. Invalid info.');
      }
    }
    
    function logout() {
      currentUser = null;
      sessionStorage.removeItem('currentUser');
      dom.portalView.classList.remove('visible');
      dom.loginContainer.classList.remove('hidden');
      dom.sidebar.classList.remove('open');
      dom.username.value = '';
      dom.password.value = '';
    }

    function showPortal() {
      if (!currentUser) return;
      dom.loginContainer.classList.add('hidden');
      dom.portalView.classList.add('visible');
      
      dom.welcomeMessage.textContent = `Hello, ${currentUser.username}`;
      dom.userNameText.textContent = currentUser.username;
      dom.userProfilePic.src = currentUser.profilePicUrl;
      dom.userProfile.style.display = 'flex';
      
      document.querySelectorAll('.admin-only').forEach(el => el.style.display = currentUser.username.toLowerCase() === 'admin' ? 'block' : 'none');
      populateButtons();
    }
    
    function showLoginMessage(msg) {
      dom.errorMessage.textContent = msg;
      dom.errorMessage.style.display = 'block';
      setTimeout(() => { dom.errorMessage.style.display = 'none'; }, 3000);
    }
    
    function updateClock() {
        const clockEl = document.getElementById('clock');
        if (clockEl) clockEl.textContent = new Date().toLocaleTimeString('en-US', { hour: '2-digit', minute: '2-digit' });
    }
    
    // --- UPDATED RENDER LOGIC FOR NEW CARDS ---
    function populateButtons() {
        dom.buttonContainer.innerHTML = '';
        const userPermissions = getFromLocalStorage(PERMISSIONS_KEY, {})[currentUser.username] || [];
        const isAdmin = currentUser.username.toLowerCase() === 'admin';
        
        allButtons = isAdmin ? ALL_BUTTONS_DATA : ALL_BUTTONS_DATA.filter(btn => userPermissions.includes(btn.id));
        filteredButtons = [...allButtons];
        
        const categories = [...new Set(allButtons.map(btn => btn.category))].sort();
        dom.categoryFilter.innerHTML = '<option value="all">All Categories</option>';
        categories.forEach(category => {
            const option = document.createElement('option');
            option.value = category;
            option.textContent = category;
            dom.categoryFilter.appendChild(option);
        });
        
        renderButtons();
    }
    
    function renderButtons() {
        dom.buttonContainer.innerHTML = '';
        
        if (filteredButtons.length === 0) {
            dom.buttonContainer.innerHTML = '<div style="grid-column: 1/-1; text-align:center; color: var(--text-muted); padding: 40px;">No tools found.</div>';
            return;
        }
        
        filteredButtons.forEach((btnData, index) => {
            const btnElement = document.createElement('a');
            btnElement.href = btnData.href;
            btnElement.className = 'tool-card';
            btnElement.target = '_blank';
            // Animation staggered
            btnElement.style.animation = `modalSlide 0.5s ease-out forwards ${index * 0.05}s`;
            btnElement.style.opacity = '0'; 
            
            btnElement.innerHTML = `
                <div class="icon-box"><i class="${btnData.icon}"></i></div>
                <div class="card-text">
                    <h3>${btnData.text}</h3>
                    <p>${btnData.category}</p>
                </div>
                <i class="fas fa-arrow-right arrow-icon"></i>
            `;
            dom.buttonContainer.appendChild(btnElement);
        });
    }
    
    function filterButtons() {
        const searchTerm = dom.searchInput.value.toLowerCase();
        const selectedCategory = dom.categoryFilter.value;
        
        filteredButtons = allButtons.filter(btn => {
            const matchesSearch = btn.text.toLowerCase().includes(searchTerm) || 
                                 btn.category.toLowerCase().includes(searchTerm);
            const matchesCategory = selectedCategory === 'all' || btn.category === selectedCategory;
            
            return matchesSearch && matchesCategory;
        });
        
        renderButtons();
    }

    function openModal(modalId) { document.getElementById(modalId).style.display = 'block'; }
    function showUserManagementMessage(msg, type = 'success') {
        dom.userManagementMessage.textContent = msg;
        dom.userManagementMessage.style.color = type === 'success' ? '#4ade80' : '#f87171';
        dom.userManagementMessage.style.display = 'block';
        setTimeout(() => dom.userManagementMessage.style.display = 'none', 3000);
    }
    
    function openNotepad() {
        dom.notepadTextarea.value = getFromLocalStorage('notepad_' + currentUser.username, '');
        openModal('notepadModal');
    }
    function saveNotepad() {
        saveToLocalStorage('notepad_' + currentUser.username, dom.notepadTextarea.value);
        dom.notepadModal.style.display = 'none';
    }

    function openUserManagement() {
        populateUsersDropdown();
        dom.permissionsContainer.style.display = 'none';
        openModal('userManagementModal');
    }
    function populateUsersDropdown() {
        const users = getFromLocalStorage(USERS_KEY, []);
        dom.selectUserForPermissions.innerHTML = '<option value="">-- Select User --</option>';
        users.filter(u => u.username.toLowerCase() !== 'admin').forEach(u => {
            const option = new Option(u.username, u.username);
            dom.selectUserForPermissions.add(option);
        });
    }
    function createUser() {
        const username = dom.newUsername.value.trim();
        const password = dom.newPassword.value.trim();
        if (!username || !password) return showUserManagementMessage('Fields cannot be empty', 'error');

        let users = getFromLocalStorage(USERS_KEY, []);
        if (users.some(u => u.username.toLowerCase() === username.toLowerCase())) return showUserManagementMessage('User exists', 'error');
        
        users.push({ username, password: simpleHash(password), profilePicUrl: 'https://i.pravatar.cc/150?u=' + username });
        saveToLocalStorage(USERS_KEY, users);
        showUserManagementMessage('User created');
        dom.newUsername.value = '';
        dom.newPassword.value = '';
        populateUsersDropdown();
    }
    function loadPermissionsForUser() {
        const username = dom.selectUserForPermissions.value;
        dom.deleteUserBtn.disabled = !username;
        if (!username) { dom.permissionsContainer.style.display = 'none'; return; }
        
        const allPermissions = getFromLocalStorage(PERMISSIONS_KEY, {});
        const userPermissions = allPermissions[username] || [];
        
        dom.permissionsList.innerHTML = '';
        ALL_BUTTONS_DATA.forEach(btn => {
            const isChecked = userPermissions.includes(btn.id);
            dom.permissionsList.innerHTML += `
                <div style="padding: 8px; display:flex; gap:10px; align-items:center; border-bottom:1px solid #1f2937;">
                    <input type="checkbox" id="perm-${btn.id}" value="${btn.id}" ${isChecked ? 'checked' : ''}>
                    <label for="perm-${btn.id}" style="color:#9ca3af; cursor:pointer;">${btn.text}</label>
                </div>`;
        });
        dom.permissionsContainer.style.display = 'block';
    }
    function savePermissions() {
        const username = dom.selectUserForPermissions.value;
        if (!username) return;

        let allPermissions = getFromLocalStorage(PERMISSIONS_KEY, {});
        const selectedPermissions = Array.from(dom.permissionsList.querySelectorAll('input:checked')).map(input => input.value);
        allPermissions[username] = selectedPermissions;
        saveToLocalStorage(PERMISSIONS_KEY, allPermissions);
        showUserManagementMessage('Saved');
    }
    function deleteUser() {
        const username = dom.selectUserForPermissions.value;
        if (!username || !confirm(`Delete ${username}?`)) return;
        
        let users = getFromLocalStorage(USERS_KEY, []).filter(u => u.username !== username);
        saveToLocalStorage(USERS_KEY, users);

        let allPermissions = getFromLocalStorage(PERMISSIONS_KEY, {});
        delete allPermissions[username];
        saveToLocalStorage(PERMISSIONS_KEY, allPermissions);
        
        showUserManagementMessage('Deleted');
        populateUsersDropdown();
        dom.permissionsContainer.style.display = 'none';
    }

    function initDefaultUsers() {
      let users = getFromLocalStorage(USERS_KEY, []);
      const defaultPic = 'https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png';
      
      const ensureUser = (username, password) => {
        if (!users.some(u => u.username.toLowerCase() === username.toLowerCase())) {
          users.push({ username, password: simpleHash(password), profilePicUrl: defaultPic });
        }
      };
      
      ensureUser('admin', 'aminehu@123');
      ensureUser('amit', 'aminehu@123');
      saveToLocalStorage(USERS_KEY, users);
    }
  </script>
</body>
</html>
