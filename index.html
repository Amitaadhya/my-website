<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Amit Chaudhary | Complete Premium Dashboard</title>
  <link rel="icon" href="https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png" type="image/png">
  
  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Space+Grotesk:wght@500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  
  <style>
    :root {
      --bg-dark: #0a0a0a;
      --bg-card: rgba(17, 24, 39, 0.6);
      --accent: #00d4ff;
      --accent-glow: rgba(0, 212, 255, 0.4);
      --text-main: #ffffff;
      --text-muted: #a0aec0;
      --glass-bg: rgba(17, 24, 39, 0.4);
      --glass-border: rgba(255, 255, 255, 0.1);
      --sidebar-width: 280px;
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-3: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --shadow-soft: 0 25px 50px -12px rgba(0, 0, 0, 0.8);
      --shadow-glow: 0 0 40px var(--accent-glow);
    }

    /* Premium Theme Variations */
    body[data-theme="blue"] {
      --accent: #00d4ff;
      --accent-glow: rgba(0, 212, 255, 0.4);
      --gradient-1: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
      --gradient-2: linear-gradient(135deg, #00c6fb 0%, #005bea 100%);
    }
    body[data-theme="purple"] {
      --accent: #a78bfa;
      --accent-glow: rgba(167, 139, 250, 0.4);
      --gradient-1: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      --gradient-2: linear-gradient(135deg, #a78bfa 0%, #8b5cf6 100%);
    }
    body[data-theme="green"] {
      --accent: #4ade80;
      --accent-glow: rgba(74, 222, 128, 0.4);
      --gradient-1: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%);
      --gradient-2: linear-gradient(135deg, #4ade80 0%, #22c55e 100%);
    }
    body[data-theme="orange"] {
      --accent: #f59e0b;
      --accent-glow: rgba(245, 158, 11, 0.4);
      --gradient-1: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
      --gradient-2: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', sans-serif;
      background: var(--bg-dark);
      color: var(--text-main);
      overflow-x: hidden;
      min-height: 100vh;
      position: relative;
    }

    /* Enhanced Animated Background */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: 
        radial-gradient(circle at 20% 50%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 80% 80%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
        radial-gradient(circle at 40% 20%, rgba(255, 219, 98, 0.3) 0%, transparent 50%);
      animation: backgroundShift 20s ease-in-out infinite;
      z-index: -2;
    }

    @keyframes backgroundShift {
      0%, 100% { transform: scale(1) rotate(0deg); }
      50% { transform: scale(1.1) rotate(180deg); }
    }

    /* Premium Scrollbar */
    ::-webkit-scrollbar { width: 10px; }
    ::-webkit-scrollbar-track { 
      background: rgba(255, 255, 255, 0.05); 
      border-radius: 10px; 
    }
    ::-webkit-scrollbar-thumb { 
      background: var(--gradient-1);
      border-radius: 10px; 
      border: 2px solid transparent;
      background-clip: content-box;
      transition: background 0.3s;
    }
    ::-webkit-scrollbar-thumb:hover { 
      background: var(--accent);
      box-shadow: 0 0 20px var(--accent-glow);
    }

    /* Premium Preloader */
    #preloader {
      position: fixed; inset: 0; background: var(--bg-dark); z-index: 9999;
      display: flex; justify-content: center; align-items: center;
      transition: 0.5s;
    }
    #preloader.hidden { opacity: 0; pointer-events: none; }
    .loader {
      width: 80px; height: 80px;
      border: 3px solid rgba(255,255,255,0.1);
      border-radius: 50%; border-top-color: var(--accent);
      animation: spin 1s ease-in-out infinite;
      box-shadow: 0 0 40px var(--accent-glow);
      position: relative;
    }
    .loader::before {
      content: ''; position: absolute; inset: -5px;
      border-radius: 50%; border: 2px solid transparent;
      border-top-color: #764ba2; animation: spin 1.5s ease-in-out infinite;
    }
    .loader::after {
      content: ''; position: absolute; inset: -10px;
      border-radius: 50%; border: 1px solid transparent;
      border-top-color: var(--accent); animation: spin 2s ease-in-out infinite;
    }
    @keyframes spin { 
      to { transform: rotate(360deg); } 
    }

    /* Premium Login Screen with Advanced Glassmorphism */
    .login-container {
      position: fixed; inset: 0; z-index: 2000;
      display: flex; justify-content: center; align-items: center;
      background: rgba(10, 10, 10, 0.9);
      backdrop-filter: blur(20px);
      transition: 0.5s;
    }
    .login-container.hidden { opacity: 0; visibility: hidden; transform: scale(0.95); }

    .login-box {
      width: 100%; max-width: 450px;
      padding: 50px 40px;
      background: rgba(17, 24, 39, 0.2);
      border: 1px solid rgba(255, 255, 255, 0.15);
      border-radius: 32px;
      box-shadow: 
        0 25px 50px -12px rgba(0, 0, 0, 0.8),
        0 0 0 1px rgba(0, 212, 255, 0.1),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
      text-align: center;
      position: relative;
      overflow: hidden;
      margin: 20px;
      backdrop-filter: blur(25px);
      transform: perspective(1000px) rotateX(5deg);
      transition: transform 0.3s;
    }
    
    .login-box:hover {
      transform: perspective(1000px) rotateX(0deg) scale(1.02);
    }
    
    .login-box::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 1px;
      background: linear-gradient(90deg, transparent, var(--accent), transparent);
      animation: shimmer 2s infinite;
    }
    
    @keyframes shimmer {
      0% { transform: translateX(-100%); }
      100% { transform: translateX(100%); }
    }

    .logo-glow {
      width: 120px; height: 120px; margin: 0 auto 30px;
      border-radius: 50%; padding: 6px;
      background: var(--gradient-1);
      box-shadow: 0 0 60px var(--accent-glow);
      border: 2px solid rgba(255, 255, 255, 0.2);
      animation: pulse 2s infinite;
      position: relative;
    }
    
    @keyframes pulse {
      0%, 100% { transform: scale(1); }
      50% { transform: scale(1.05); }
    }
    
    .logo-glow img { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; }

    .login-box h1 { 
      font-family: 'Space Grotesk', sans-serif; 
      font-size: 2.5rem; 
      margin-bottom: 10px; 
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -1px;
    }
    .login-box > p { color: var(--text-muted); font-size: 1rem; margin-bottom: 40px; }

    .input-field {
      position: relative; margin-bottom: 25px;
    }
    .input-field i {
      position: absolute; left: 20px; top: 50%; transform: translateY(-50%);
      color: var(--text-muted); transition: 0.3s; z-index: 1;
    }
    .input-field input {
      width: 100%; padding: 18px 18px 18px 50px;
      background: rgba(0,0,0,0.3);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 16px;
      color: white; font-size: 1.1rem;
      transition: 0.3s;
      backdrop-filter: blur(10px);
    }
    .input-field input::placeholder { color: var(--text-muted); }
    .input-field input:focus {
      outline: none; border-color: var(--accent);
      box-shadow: 0 0 0 4px var(--accent-glow), 0 10px 30px -10px var(--accent-glow);
      background: rgba(0,0,0,0.4);
      transform: translateY(-2px);
    }
    .input-field:focus-within i { color: var(--accent); }

    .btn-primary {
      width: 100%; padding: 18px;
      background: var(--gradient-1);
      color: white; font-weight: 700;
      border: none; border-radius: 16px;
      cursor: pointer; font-size: 1.1rem;
      transition: 0.3s; text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: 0 15px 35px -10px var(--accent-glow);
      position: relative;
      overflow: hidden;
      margin-top: 10px;
    }
    .btn-primary::before {
      content: ''; position: absolute; top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
      transition: 0.5s;
    }
    .btn-primary:hover::before {
      left: 100%;
    }
    .btn-primary:hover {
      transform: translateY(-3px);
      box-shadow: 0 20px 40px -10px var(--accent-glow);
    }
    .btn-primary:active { transform: translateY(-1px); }

    /* Enhanced Main Layout */
    .portal-view {
      display: flex; min-height: 100vh; overflow: hidden;
      opacity: 0; pointer-events: none; transition: 0.5s;
      position: relative;
    }
    .portal-view.visible { opacity: 1; pointer-events: auto; }
    
    /* Magic Background Glow */
    #background-glow {
      position: fixed;
      top: var(--mouse-y, 50%);
      left: var(--mouse-x, 50%);
      width: 1000px;
      height: 1000px;
      background: radial-gradient(circle, var(--accent-glow) 0%, transparent 70%);
      transform: translate(-50%, -50%);
      transition: top 0.3s ease-out, left 0.3s ease-out;
      pointer-events: none;
      z-index: -1;
      filter: blur(40px);
    }

    /* Premium Sidebar with Glassmorphism */
    .sidebar {
      width: var(--sidebar-width); min-height: 100vh;
      background: rgba(17, 24, 39, 0.4);
      border-right: 1px solid rgba(255, 255, 255, 0.1);
      display: flex; flex-direction: column;
      padding: 30px 24px; z-index: 100;
      transition: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      position: fixed; left: 0; top: 0; bottom: 0;
      backdrop-filter: blur(25px);
    }

    .brand-logo {
      display: flex; align-items: center; gap: 12px;
      margin-bottom: 50px; padding-left: 10px;
    }
    .brand-logo i { 
      font-size: 1.8rem; 
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .brand-logo span { 
      font-family: 'Space Grotesk', sans-serif; 
      font-size: 1.4rem; 
      font-weight: 700; 
      background: var(--gradient-2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }

    .nav-links { flex: 1; list-style: none; display: flex; flex-direction: column; gap: 8px; }
    .nav-item a {
      display: flex; align-items: center; gap: 14px;
      padding: 16px 18px; border-radius: 16px;
      color: var(--text-muted); text-decoration: none;
      font-weight: 500; transition: 0.3s; cursor: pointer;
      position: relative;
      overflow: hidden;
      border: 1px solid transparent;
    }
    .nav-item a::before {
      content: ''; position: absolute; top: 0; left: -100%;
      width: 100%; height: 100%;
      background: linear-gradient(90deg, transparent, rgba(0, 212, 255, 0.1), transparent);
      transition: 0.5s;
    }
    .nav-item a:hover::before {
      left: 100%;
    }
    .nav-item a:hover {
      background: rgba(255,255,255,0.05); color: white;
      transform: translateX(5px);
      border-color: rgba(255, 255, 255, 0.1);
    }
    .nav-item a.active {
      background: linear-gradient(90deg, rgba(0, 212, 255, 0.15), transparent);
      color: var(--accent); border-left: 3px solid var(--accent);
      border-color: var(--accent);
    }
    .nav-item i { width: 20px; text-align: center; }

    /* Enhanced Theme Customizer */
    .theme-customizer {
      margin-top: 30px;
      padding-top: 20px;
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    .theme-customizer h4 {
      font-size: 0.8rem;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 15px;
      padding-left: 10px;
    }
    .theme-swatches {
      display: flex;
      gap: 15px;
      justify-content: center;
    }
    .swatch {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      cursor: pointer;
      border: 3px solid transparent;
      transition: all 0.3s;
      position: relative;
      overflow: hidden;
    }
    .swatch::before {
      content: ''; position: absolute; inset: 0;
      background: radial-gradient(circle, rgba(255,255,255,0.3) 0%, transparent 70%);
      opacity: 0; transition: 0.3s;
    }
    .swatch:hover {
      transform: scale(1.1);
    }
    .swatch:hover::before {
      opacity: 1;
    }
    .swatch.active {
      border-color: white;
      box-shadow: 0 0 20px rgba(255,255,255,0.5);
      transform: scale(1.1);
    }
    #swatch-blue { background: #00d4ff; }
    #swatch-purple { background: #a78bfa; }
    #swatch-green { background: #4ade80; }
    #swatch-orange { background: #f59e0b; }

    .user-panel {
      padding: 20px; background: rgba(0,0,0,0.2);
      border-radius: 20px; display: flex; align-items: center; gap: 12px;
      border: 1px solid rgba(255, 255, 255, 0.1); margin-top: auto;
      transition: 0.3s;
      backdrop-filter: blur(10px);
    }
    .user-panel:hover {
      background: rgba(0,0,0,0.3);
      transform: translateY(-2px);
      box-shadow: 0 10px 30px -10px var(--accent-glow);
    }
    .user-panel img { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; }
    .user-details h4 { font-size: 0.95rem; margin-bottom: 2px; }
    .logout-btn { font-size: 0.75rem; color: #ef4444; cursor: pointer; text-decoration: none; }
    .logout-btn:hover { text-decoration: underline; }

    /* Enhanced Main Content */
    .main-content {
      flex: 1; min-height: 100vh; overflow-y: auto;
      padding: 40px; position: relative;
      margin-left: var(--sidebar-width);
    }

    .header-bar {
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 50px; flex-wrap: wrap; gap: 15px;
    }
    .welcome-section h2 { 
      font-family: 'Space Grotesk', sans-serif; 
      font-size: 3rem; 
      background: var(--gradient-3);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      letter-spacing: -2px;
      margin-bottom: 5px;
    }
    .welcome-section p { color: var(--text-muted); font-size: 1.1rem; }
    
    .clock-badge {
      background: rgba(0, 212, 255, 0.1); color: var(--accent);
      padding: 12px 24px; border-radius: 30px; border: 1px solid rgba(0, 212, 255, 0.2);
      font-family: 'Space Grotesk', monospace; font-weight: 600;
      backdrop-filter: blur(10px);
      animation: glow 2s infinite alternate;
      font-size: 1.1rem;
    }
    
    @keyframes glow {
      from { box-shadow: 0 0 20px rgba(0, 212, 255, 0.3); }
      to { box-shadow: 0 0 40px rgba(0, 212, 255, 0.6); }
    }

    /* Enhanced Search Bar */
    .toolbar {
      display: flex; gap: 20px; margin-bottom: 40px;
      background: rgba(17, 24, 39, 0.4); padding: 15px;
      border-radius: 20px; border: 1px solid rgba(255, 255, 255, 0.1);
      flex-wrap: wrap; backdrop-filter: blur(10px);
      box-shadow: 0 10px 30px -10px rgba(0, 0, 0, 0.5);
    }
    .search-wrap { flex: 1; position: relative; min-width: 200px; }
    .search-wrap input {
      width: 100%; padding: 16px 16px 16px 50px;
      background: rgba(0,0,0,0.2); border: none;
      color: white; font-size: 1.1rem;
      border-radius: 16px;
      transition: 0.3s;
    }
    .search-wrap input::placeholder { color: var(--text-muted); }
    .search-wrap input:focus { 
      outline: none; 
      background: rgba(0,0,0,0.3);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }
    .search-wrap i { position: absolute; left: 20px; top: 50%; transform: translateY(-50%); color: var(--text-muted); }
    
    .category-select {
      background: rgba(0,0,0,0.3); color: white; border: none;
      padding: 16px 24px; border-radius: 16px; cursor: pointer;
      outline: none; font-family: 'Inter', sans-serif;
      min-width: 150px; border: 1px solid rgba(255, 255, 255, 0.1);
      transition: 0.3s; font-size: 1rem;
    }
    .category-select:focus {
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-glow);
    }

    /* Premium Tool Cards with Advanced 3D Effects */
    .grid-container {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 30px; padding-bottom: 60px;
    }

    .tool-card {
      position: relative;
      background: rgba(17, 24, 39, 0.4);
      padding: 32px; border-radius: 24px;
      text-decoration: none; color: white;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
      display: flex; flex-direction: column;
      justify-content: space-between;
      min-height: 200px; overflow: hidden;
      backdrop-filter: blur(15px);
      transform-style: preserve-3d;
      perspective: 1000px;
    }
    
    .tool-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background: linear-gradient(135deg, transparent, rgba(0, 212, 255, 0.1), transparent);
      opacity: 0; transition: 0.3s;
    }
    
    .tool-card:hover::before {
      opacity: 1;
    }
    
    .tool-card:hover {
      border-color: var(--accent);
      box-shadow: 
        0 30px 60px -15px rgba(0, 0, 0, 0.7), 
        0 0 50px var(--accent-glow);
      transform: translateY(-10px);
    }
    
    .icon-box {
      width: 70px; height: 70px;
      background: rgba(255,255,255,0.05);
      border-radius: 20px;
      display: flex; justify-content: center; align-items: center;
      font-size: 2rem; color: var(--accent);
      margin-bottom: 25px; transition: 0.3s;
      position: relative;
      overflow: hidden;
      transform: translateZ(40px);
    }
    
    .icon-box::before {
      content: ''; position: absolute; inset: 0;
      background: var(--gradient-1);
      opacity: 0; transition: 0.3s;
    }
    
    .tool-card:hover .icon-box::before {
      opacity: 1;
    }
    
    .tool-card:hover .icon-box {
      transform: translateZ(60px) rotate(-10deg) scale(1.1);
      color: white;
    }
    
    .icon-box i {
      position: relative;
      z-index: 1;
    }
    
    .card-text {
        transform: translateZ(30px);
    }
    .card-text h3 { 
      font-size: 1.3rem; 
      font-weight: 600; 
      line-height: 1.4; 
      margin-bottom: 10px; 
      background: linear-gradient(135deg, white, #e2e8f0);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .card-text p { 
      font-size: 0.9rem; 
      color: var(--text-muted); 
      text-transform: uppercase; 
      letter-spacing: 0.5px; 
      font-weight: 500;
    }
    
    .arrow-icon {
      position: absolute; bottom: 30px; right: 30px;
      opacity: 0; transform: translateX(-10px); transition: 0.3s;
      color: var(--accent);
      font-size: 1.3rem;
      transform: translateZ(50px);
    }
    .tool-card:hover .arrow-icon { 
      opacity: 1; 
      transform: translateZ(50px) translateX(0); 
      animation: bounce 0.6s infinite;
    }
    
    @keyframes bounce {
      0%, 100% { transform: translateZ(50px) translateX(0); }
      50% { transform: translateZ(50px) translateX(5px); }
    }

    @keyframes cardFadeIn {
      from { opacity: 0; transform: translateY(30px) scale(0.9); }
      to { opacity: 1; transform: translateY(0) scale(1); }
    }

    /* Premium Double List Layout */
    .double-list-container {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-bottom: 50px;
    }
    
    .list-section {
      background: rgba(17, 24, 39, 0.4);
      border: 1px solid rgba(255, 255, 255, 0.1);
      border-radius: 24px;
      padding: 30px;
      backdrop-filter: blur(15px);
      transition: 0.3s;
    }
    
    .list-section:hover {
      box-shadow: 0 20px 40px -10px rgba(0, 0, 0, 0.5);
      transform: translateY(-5px);
    }
    
    .list-header {
      display: flex;
      align-items: center;
      gap: 15px;
      margin-bottom: 25px;
      padding-bottom: 20px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }
    
    .list-header h3 {
      font-family: 'Space Grotesk', sans-serif;
      font-size: 1.4rem;
      background: var(--gradient-2);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    
    .list-header i {
      color: var(--accent);
      font-size: 1.3rem;
    }
    
    .list-items {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    
    .list-item {
      display: flex;
      align-items: center;
      gap: 15px;
      padding: 16px;
      background: rgba(0,0,0,0.2);
      border-radius: 16px;
      border: 1px solid rgba(255, 255, 255, 0.1);
      transition: 0.3s;
      cursor: pointer;
      text-decoration: none;
      color: white;
    }
    
    .list-item:hover {
      background: rgba(0, 212, 255, 0.1);
      border-color: var(--accent);
      transform: translateX(8px);
      box-shadow: 0 10px 30px -10px var(--accent-glow);
    }
    
    .list-item-icon {
      width: 45px; height: 45px;
      background: var(--gradient-1);
      border-radius: 12px;
      display: flex; align-items: center; justify-content: center;
      font-size: 1.3rem; color: white;
    }
    
    .list-item-content {
      flex: 1;
    }
    
    .list-item-title {
      font-weight: 600; font-size: 1rem;
      margin-bottom: 3px;
    }
    
    .list-item-desc {
      font-size: 0.85rem; color: var(--text-muted);
    }

    /* Enhanced Modals */
    .modal {
      display: none; position: fixed; inset: 0; z-index: 3000;
      background: rgba(0,0,0,0.9); backdrop-filter: blur(20px);
      overflow-y: auto; padding: 20px;
    }
    .modal-content {
      background: rgba(17, 24, 39, 0.5);
      border: 1px solid rgba(255, 255, 255, 0.15);
      width: 95%; max-width: 700px;
      margin: 50px auto; padding: 40px;
      border-radius: 32px;
      box-shadow: 0 40px 80px rgba(0,0,0,0.8);
      animation: modalSlide 0.4s ease-out;
      position: relative;
      backdrop-filter: blur(30px);
    }
    @keyframes modalSlide { 
      from { opacity: 0; transform: translateY(20px) scale(0.9); } 
      to { opacity: 1; transform: translateY(0) scale(1); } 
    }
    
    .modal-header { 
      display: flex; justify-content: space-between; align-items: center;
      margin-bottom: 30px; border-bottom: 1px solid rgba(255, 255, 255, 0.1); 
      padding-bottom: 20px; 
    }
    .modal-header h2 { 
      font-family: 'Space Grotesk', sans-serif; 
      display: flex; align-items: center; gap: 10px; 
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      font-size: 1.8rem;
    }
    .close-btn { 
      font-size: 2rem; cursor: pointer; color: var(--text-muted); 
      transition: 0.3s; 
      width: 45px; height: 45px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 50%;
    }
    .close-btn:hover { 
      color: #ef4444; 
      background: rgba(239, 68, 68, 0.1);
      transform: rotate(90deg);
    }
    
    textarea, .modal select, .modal input[type="text"], .modal input[type="password"] { 
      width: 100%; background: rgba(0,0,0,0.3); border: 1px solid rgba(255, 255, 255, 0.1); 
      color: white; padding: 18px; border-radius: 16px; 
      font-family: 'Inter'; outline: none; transition: 0.3s;
      font-size: 1rem;
    }
    textarea:focus, .modal select:focus, .modal input:focus { 
      border-color: var(--accent); 
      box-shadow: 0 0 0 3px var(--accent-glow);
    }
    textarea { resize: vertical; min-height: 150px; }

    .form-group { margin-bottom: 25px; }
    .form-group label { display: block; margin-bottom: 8px; color: var(--text-muted); font-size: 0.9rem; }

    /* Enhanced User Management */
    .user-mgmt-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 40px; }
    .user-mgmt-section h3 { 
      font-size: 1.1rem; margin-bottom: 20px; color: var(--accent); 
      display: flex; align-items: center; gap: 8px;
    }
    .permissions-list { 
      max-height: 200px; overflow-y: auto; 
      background: rgba(0,0,0,0.3); padding: 15px; border-radius: 16px; 
      border: 1px solid rgba(255, 255, 255, 0.1);
    }
    .permission-item {
      padding: 12px; display: flex; gap: 10px; align-items: center;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1); transition: 0.2s;
    }
    .permission-item:hover { background: rgba(0, 212, 255, 0.05); }
    .permission-item:last-child { border-bottom: none; }
    .permission-item input[type="checkbox"] { 
      width: 18px; height: 18px; accent-color: var(--accent); cursor: pointer;
    }
    .permission-item label { color: #9ca3af; cursor: pointer; font-size: 0.9rem; flex: 1; }

    .btn-danger {
      background: linear-gradient(135deg, #ef4444, #dc2626); color: white; border: none;
      padding: 14px 24px; border-radius: 16px; cursor: pointer;
      font-weight: 600; transition: 0.3s; width: 100%;
      position: relative; overflow: hidden;
    }
    .btn-danger:hover { 
      background: linear-gradient(135deg, #dc2626, #b91c1c); 
      transform: translateY(-2px);
    }
    .btn-danger:disabled { opacity: 0.5; cursor: not-allowed; }

    .message-box {
      padding: 16px; border-radius: 16px; text-align: center;
      margin-bottom: 25px; font-weight: 500; display: none;
    }
    .message-box.success { 
      background: rgba(74, 222, 128, 0.1); 
      color: #4ade80; 
      border: 1px solid rgba(74, 222, 128, 0.3); 
    }
    .message-box.error { 
      background: rgba(248, 113, 113, 0.1); 
      color: #f87171; 
      border: 1px solid rgba(248, 113, 113, 0.3); 
    }

    /* Enhanced Profile Modal */
    .profile-card {
      text-align: center; padding: 30px;
    }
    .profile-card img {
      width: 140px; height: 140px; border-radius: 50%;
      border: 3px solid var(--accent); margin-bottom: 20px;
      box-shadow: 0 0 40px var(--accent-glow);
      transition: 0.3s;
    }
    .profile-card img:hover {
      transform: scale(1.05);
    }
    .profile-card h3 { font-size: 2rem; margin-bottom: 5px; }
    .profile-card p { color: var(--text-muted); font-size: 1.1rem; }
    .profile-stats {
      display: flex; justify-content: center; gap: 40px; margin-top: 30px;
      padding-top: 30px; border-top: 1px solid rgba(255, 255, 255, 0.1);
    }
    .stat-item { text-align: center; }
    .stat-item .number { 
      font-size: 2.2rem; 
      font-weight: 700; 
      background: var(--gradient-1);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
    }
    .stat-item .label { font-size: 0.9rem; color: var(--text-muted); }

    /* Enhanced No Results */
    .no-results {
      grid-column: 1 / -1; text-align: center; padding: 80px 20px;
      color: var(--text-muted);
    }
    .no-results i { font-size: 5rem; margin-bottom: 25px; opacity: 0.5; animation: float 3s infinite; }
    @keyframes float {
      0%, 100% { transform: translateY(0); }
      50% { transform: translateY(-15px); }
    }
    .no-results p { font-size: 1.3rem; }

    /* Mobile Menu Toggle */
    #menuToggle { 
      display: none; background: none; border: none; 
      color: white; font-size: 1.5rem; cursor: pointer; margin-right: 15px; 
      transition: 0.3s;
    }
    #menuToggle:hover {
      color: var(--accent);
      transform: scale(1.1);
    }
    
    .overlay {
      display: none; position: fixed; inset: 0;
      background: rgba(0,0,0,0.5); z-index: 99;
      backdrop-filter: blur(5px);
    }
    .overlay.active { display: block; }

    /* Responsive */
    @media (max-width: 992px) {
      .sidebar { 
        left: -100%; width: 100%; max-width: 300px; 
        box-shadow: none;
      }
      .sidebar.open { left: 0; box-shadow: 50px 0 100px rgba(0,0,0,0.5); }
      #menuToggle { display: block; }
      .main-content { margin-left: 0; padding: 20px; }
      .header-bar { flex-direction: column; align-items: flex-start; }
      .user-mgmt-grid { grid-template-columns: 1fr; }
      .double-list-container { grid-template-columns: 1fr; }
    }

    @media (max-width: 480px) {
      .login-box { padding: 30px 20px; }
      .login-box h1 { font-size: 1.8rem; }
      .grid-container { grid-template-columns: 1fr; }
      .modal-content { padding: 20px; }
      .welcome-section h2 { font-size: 2rem; }
    }

    /* Premium Snow Effect */
    #snow-container {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 9998;
      overflow: hidden;
    }

    .snowflake {
      position: absolute;
      top: -20px;
      background: white;
      border-radius: 50%;
      opacity: 0.8;
      box-shadow: 0 0 15px rgba(255, 255, 255, 0.8);
      animation: fall linear infinite;
    }

    @keyframes fall {
      to {
        transform: translateY(105vh);
      }
    }

    /* Additional Premium Effects */
    .glow-text {
      animation: textGlow 2s ease-in-out infinite alternate;
    }

    @keyframes textGlow {
      from { text-shadow: 0 0 10px var(--accent-glow); }
      to { text-shadow: 0 0 20px var(--accent-glow), 0 0 30px var(--accent-glow); }
    }

    .premium-badge {
      position: absolute;
      top: 20px;
      right: 20px;
      background: var(--gradient-1);
      color: white;
      padding: 8px 16px;
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      box-shadow: 0 5px 15px -5px var(--accent-glow);
    }
  </style>
</head>
<body data-theme="blue">

  <!-- Enhanced Preloader -->
  <div id="preloader"><div class="loader"></div></div>

  <!-- Enhanced Login Page -->
  <div class="login-container" id="loginContainer">
    <div class="login-box">
      <div class="premium-badge">PREMIUM</div>
      <div class="logo-glow">
        <img src="https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png" alt="Logo">
      </div>
      <h1 class="glow-text">Amit Chaudhary</h1>
      <p>Welcome to your Premium Dashboard Experience</p>
      
      <div style="margin-top: 40px;">
        <div class="input-field">
          <i class="fas fa-user"></i>
          <input type="text" id="username" placeholder="Username" autocomplete="username">
        </div>
        <div class="input-field">
          <i class="fas fa-lock"></i>
          <input type="password" id="password" placeholder="Password" autocomplete="current-password">
        </div>
        
        <button class="btn-primary" id="loginBtn">
          <i class="fas fa-sign-in-alt"></i> Enter Premium Dashboard
        </button>
        <p id="errorMessage" style="color: #ef4444; margin-top: 15px; font-size: 0.85rem; display: none;"></p>
      </div>
    </div>
  </div>

  <!-- Enhanced Main Dashboard -->
  <div class="portal-view" id="portalView">
    <div id="background-glow"></div>
    <div class="overlay" id="overlay"></div>
    
    <!-- Enhanced Sidebar -->
    <nav class="sidebar" id="sidebar">
      <div class="brand-logo">
        <i class="fas fa-cube"></i>
        <span>Amit Chaudhary</span>
      </div>
      
      <ul class="nav-links">
        <li class="nav-item"><a id="dashboardLink" class="active"><i class="fas fa-th-large"></i> Dashboard</a></li>
        <li class="nav-item"><a id="myProfileBtnSidebar"><i class="fas fa-user-astronaut"></i> Profile</a></li>
        <li class="nav-item"><a id="notepadBtnSidebar"><i class="fas fa-sticky-note"></i> Notes</a></li>
        <li class="nav-item"><a id="quickToolsBtnSidebar"><i class="fas fa-bolt"></i> Quick Tools</a></li>
        <li class="nav-item"><a id="analyticsBtnSidebar"><i class="fas fa-chart-line"></i> Analytics</a></li>
        <li class="nav-item"><a id="snowToggleBtn"><i class="fas fa-snowflake"></i> Let It Snow</a></li>
        <li class="nav-item admin-only" style="display:none;"><a id="userManagementBtnSidebar"><i class="fas fa-users-cog"></i> Users</a></li>
        <li class="nav-item admin-only" style="display:none;"><a id="portalSettingsBtnSidebar"><i class="fas fa-sliders-h"></i> Settings</a></li>
      </ul>
      
      <!-- Enhanced Theme Customizer -->
      <div class="theme-customizer">
        <h4>Customize Theme</h4>
        <div class="theme-swatches">
            <div class="swatch active" id="swatch-blue" data-theme="blue"></div>
            <div class="swatch" id="swatch-purple" data-theme="purple"></div>
            <div class="swatch" id="swatch-green" data-theme="green"></div>
            <div class="swatch" id="swatch-orange" data-theme="orange"></div>
        </div>
      </div>

      <div class="user-panel" id="userProfile" style="display:none;">
        <img id="userProfilePic" src="" alt="User">
        <div class="user-details">
          <h4 id="userNameText">User</h4>
          <a id="logoutLink" class="logout-btn">Log out <i class="fas fa-sign-out-alt"></i></a>
        </div>
      </div>
    </nav>

    <!-- Enhanced Content -->
    <main class="main-content" id="mainContent">
      <header class="header-bar" id="mainHeader">
        <div style="display:flex; align-items:center;">
          <button id="menuToggle"><i class="fas fa-bars"></i></button>
          <div class="welcome-section">
            <h2 id="welcomeMessage"></h2>
            <p>Your premium mission control center</p>
          </div>
        </div>
        <div class="clock-badge" id="clock">00:00:00</div>
      </header>
      
      <!-- Enhanced Search Toolbar -->
      <div class="toolbar">
        <div class="search-wrap">
          <i class="fas fa-search"></i>
          <input type="text" id="searchInput" placeholder="Search premium tools, sheets, or data...">
        </div>
        <select class="category-select" id="categoryFilter">
          <option value="all">All Categories</option>
        </select>
      </div>
      
      <!-- Quick Tools Section -->
      <div class="double-list-container" id="quickToolsSection" style="display:none;">
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-bolt"></i>
            <h3>Quick Actions</h3>
          </div>
          <div class="list-items" id="quickActionsList"></div>
        </div>
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-star"></i>
            <h3>Favorites</h3>
          </div>
          <div class="list-items" id="favoritesList"></div>
        </div>
      </div>

      <!-- Analytics Section -->
      <div class="double-list-container" id="analyticsSection" style="display:none;">
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-chart-bar"></i>
            <h3>Sales Analytics</h3>
          </div>
          <div class="list-items" id="salesAnalyticsList"></div>
        </div>
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-chart-line"></i>
            <h3>Performance Metrics</h3>
          </div>
          <div class="list-items" id="performanceMetricsList"></div>
        </div>
      </div>
      
      <!-- Enhanced Grid -->
      <div class="grid-container" id="buttonContainer"></div>
    </main>
  </div>
  
  <!-- Modals -->
  <div id="userProfileModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-user-circle"></i> My Profile</h2>
        <span class="close-btn">&times;</span>
      </div>
      <div class="profile-card">
        <img id="profileModalPic" src="" alt="Profile">
        <h3 id="profileModalName">User</h3>
        <p id="profileModalRole">Member</p>
        <div class="profile-stats">
          <div class="stat-item">
            <div class="number" id="toolsCount">0</div>
            <div class="label">Tools Access</div>
          </div>
          <div class="stat-item">
            <div class="number" id="sessionTime">0</div>
            <div class="label">Min Session</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="notepadModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-pen"></i> My Notes</h2>
        <span class="close-btn">&times;</span>
      </div>
      <textarea id="notepadTextarea" placeholder="Type your premium notes here... Your notes are saved locally."></textarea>
      <button class="btn-primary" id="saveNotepadBtn" style="margin-top:20px;">
        <i class="fas fa-save"></i> Save Notes
      </button>
    </div>
  </div>

  <div id="quickToolsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-bolt"></i> Quick Tools</h2>
        <span class="close-btn">&times;</span>
      </div>
      <div class="double-list-container">
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-calculator"></i>
            <h3>Calculators</h3>
          </div>
          <div class="list-items" id="calculatorsList"></div>
        </div>
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-file-alt"></i>
            <h3>Document Tools</h3>
          </div>
          <div class="list-items" id="documentToolsList"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="analyticsDashboardModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-chart-line"></i> Analytics Dashboard</h2>
        <span class="close-btn">&times;</span>
      </div>
      <div class="double-list-container">
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-chart-pie"></i>
            <h3>Sales Reports</h3>
          </div>
          <div class="list-items" id="salesReportsList"></div>
        </div>
        <div class="list-section">
          <div class="list-header">
            <i class="fas fa-chart-area"></i>
            <h3>Performance Analytics</h3>
          </div>
          <div class="list-items" id="performanceAnalyticsList"></div>
        </div>
      </div>
    </div>
  </div>

  <div id="userManagementModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-users-cog"></i> User Management</h2>
        <span class="close-btn">&times;</span>
      </div>
      <div class="message-box" id="userManagementMessage"></div>
      <div class="user-mgmt-grid">
        <div class="user-mgmt-section">
          <h3><i class="fas fa-user-plus"></i> Add New User</h3>
          <div class="form-group">
            <label>Username</label>
            <input type="text" id="newUsername" placeholder="Enter username">
          </div>
          <div class="form-group">
            <label>Password</label>
            <input type="password" id="newPassword" placeholder="Enter password">
          </div>
          <button class="btn-primary" id="createUserBtn">
            <i class="fas fa-plus"></i> Create User
          </button>
        </div>
        <div class="user-mgmt-section">
          <h3><i class="fas fa-user-shield"></i> Manage Permissions</h3>
          <div class="form-group">
            <label>Select User</label>
            <select id="selectUserForPermissions">
              <option value="">-- Select User --</option>
            </select>
          </div>
          <div id="permissionsContainer" style="display:none;">
            <div class="permissions-list" id="permissionsList"></div>
            <button class="btn-primary" id="savePermissionsBtn" style="margin-top:15px;">
              <i class="fas fa-check"></i> Save Permissions
            </button>
            <button class="btn-danger" id="deleteUserBtn" style="margin-top:15px;">
              <i class="fas fa-trash"></i> Delete User
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="portalSettingsModal" class="modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2><i class="fas fa-cog"></i> Portal Settings</h2>
        <span class="close-btn">&times;</span>
      </div>
      <p style="color: var(--text-muted); text-align: center; padding: 40px;">
        <i class="fas fa-tools" style="font-size: 3rem; display: block; margin-bottom: 15px; opacity: 0.5;"></i>
        Premium settings features coming soon...
      </p>
    </div>
  </div>

  <script>
    // Constants
    const USERS_KEY = 'radnikPortalUsers_v10';
    const PERMISSIONS_KEY = 'radnikPortalPermissions_v10';
    const FAVORITES_KEY = 'radnikPortalFavorites_v10';
    const THEME_KEY = 'radnikPortalTheme_v10';
    let currentUser = null;
    let allButtons = [];
    let filteredButtons = [];
    let sessionStartTime = Date.now();

    // COMPLETE BUTTON DATA WITH ALL PROPER LINKS - VERIFIED AND WORKING
    const ALL_BUTTONS_DATA = [
      // === FINANCE TOOLS ===
      { id: "noida-tax-invoice", href: "https://docs.google.com/spreadsheets/d/1p1LreGjZFEWSY3qfkbGaWGymDa_3kzwucDH3xHoPzqU/edit", icon: "fas fa-file-invoice-dollar", text: "Noida Tax Invoice Log", category: "Finance" },
      { id: "186-tax-invoice", href: "https://docs.google.com/spreadsheets/d/1clgoSGc3BF6u25v-cumlJMqrCOZYSydWJ_xSAOpe0FE/edit", icon: "fas fa-receipt", text: "186 Tax Invoice Log", category: "Finance" },
      { id: "chargeback-form", href: "https://docs.google.com/forms/d/e/1FAIpQLSfQf5LaxGX8lLr4nN7hPmrL3mpuaFv1uzYMTaIb02IcGFHp5g/viewform", icon: "fas fa-undo-alt", text: "Chargeback Form", category: "Finance" },
      { id: "chargeback-data", href: "https://docs.google.com/spreadsheets/d/1V92jsBq9iTbYnaoaIdmYdbYc9uoFvaimxaYScnHLD7w/edit", icon: "fas fa-hand-holding-usd", text: "Chargeback Data", category: "Finance" },
      { id: "quince-invoice-summary", href: "https://docs.google.com/spreadsheets/d/1PnetSLtEPxot9N3KlB_ydbzNccAF5qMnDMRmYLo6ZLs/edit", icon: "fas fa-file-invoice", text: "Quince Invoice Summary", category: "Finance" },
      { id: "ggn-revenue-chargeback", href: "https://script.google.com/macros/s/AKfycbw6qke8xOhYaqaxcjFOgp-_wtWAwXEAfVqJA8e6-A/dev", icon: "fas fa-file-excel", text: "GGN Revenue & Chargeback Summary", category: "Finance" },
      { id: "noida-revenue-chargeback", href: "https://script.google.com/macros/s/AKfycbw1Dpw--Ar3rNg3IgPn3e32gpUODmv_O12053XHUYc/dev", icon: "far fa-file-excel", text: "NOIDA Revenue & Chargeback Summary", category: "Finance" },
      { id: "payment-management", href: "https://script.google.com/macros/s/AKfycbwEj1e1d0DfYqaTPbDarQTTYiMaiRWOodd5Cu6x4Sc/dev", icon: "fas fa-credit-card", text: "Radnik Q Payment Management", category: "Finance" },

      // === SALES TOOLS ===
      { id: "daily-sale-186", href: "https://radnikexports1-my.sharepoint.com/:x:/r/personal/amit_chaudhary_radnikexports1_onmicrosoft_com/_layouts/15/Doc.aspx?sourcedoc=%7B5DE750E6-1A38-4B42-B02D-44A3D95B2D14%7D&file=Book%206.xlsx&action=editnew", icon: "fas fa-calendar-day", text: "Daily Sale 186", category: "Sales" },
      { id: "dsec16-sale", href: "https://radnikexports1-my.sharepoint.com/:x:/r/personal/amit_chaudhary_radnikexports1_onmicrosoft_com/_layouts/15/Doc.aspx?sourcedoc=%7B866121D0-C91C-4F09-9F0B-909FBB0C2324%7D&file=DAILY%20SALE%20ENTERY%20NOIDA.xlsx&action=default", icon: "fas fa-cash-register", text: "D-S-E-C16 (Noida Sale)", category: "Sales" },
      { id: "noida-order-entry", href: "https://docs.google.com/spreadsheets/d/11RCeL6pUqN8khww5sY_iA_t-mNgrzwQNvV-bRtLKA9s/edit", icon: "fas fa-clipboard-check", text: "Noida Order Entry", category: "Sales" },
      { id: "quince-2024-sale", href: "https://docs.google.com/spreadsheets/d/1c4VbDj3CCp_Lr2MCpoJXmlp2K9qP6L3pIA0eZq52PDM/edit", icon: "fas fa-database", text: "QUINCE 2024 SALE DATA", category: "Sales" },
      { id: "quince-2025-pos", href: "https://docs.google.com/spreadsheets/d/17RWCZ62o2nRvMgZjfi_fZ6AyBQ0YmHNoIp-CCRSxJjg/edit", icon: "fas fa-shopping-cart", text: "QUINCE 2025 POS DATA", category: "Sales" },
      { id: "ggn-sales-overview", href: "https://docs.google.com/spreadsheets/d/1riS3U9aPW7s8SQmqaZkGrb2fHVEdDbJdHxwdygaeKXc/edit", icon: "fas fa-city", text: "Gurugram Sales Overview", category: "Sales" },
      { id: "noida-sales-overview", href: "https://docs.google.com/spreadsheets/d/15Xma9DRkRectWPqUKDQlr5yZQMtCfQ2Bxa_J5vU-Es0/edit", icon: "fas fa-building-user", text: "Noida Sales Overview", category: "Sales" },
      { id: "quince-order-chart", href: "https://docs.google.com/spreadsheets/d/1JFI22zsy2Pa5d2lq4dcEeCZIg7rqFaBMYPzniBdlhMc/edit", icon: "fas fa-list-ol", text: "QUINCE ORDER CHART", category: "Sales" },
      { id: "quince-sale-hub", href: "https://docs.google.com/spreadsheets/d/1_5-nGWZmyI5WkTSp6muKe7uEhel7DoAzX1oisoBz1Xw/edit", icon: "fas fa-sitemap", text: "Quince Sale All Data Hub", category: "Sales" },
      { id: "quince-style-value", href: "https://docs.google.com/spreadsheets/d/1GQucVQMxZanFgg27PGDpflR49a6DksezH4Pby2uFu4A/edit", icon: "fas fa-dollar-sign", text: "QUINCE Style Name Wise Value", category: "Sales" },
      { id: "quince-returns-data", href: "https://docs.google.com/spreadsheets/d/1zPpTDeF6PcnZ8sNpJtl_mLkUX1GihxynH7gYwFhxais/edit?gid=0#gid=0", icon: "fas fa-undo", text: "Quince Returns Data", category: "Sales" },

      // === ANALYTICS TOOLS ===
      { id: "live-graph-quince", href: "https://docs.google.com/spreadsheets/d/17XLwAmZxvmxOaB-DzPIBjuGmb3u_Zxz9_1aGn175yeE/edit", icon: "fas fa-chart-line", text: "Live Graph Quince", category: "Analytics" },
      { id: "186-qs-view", href: "https://docs.google.com/spreadsheets/d/e/2PACX-1vQ_ihmuGBmPjY_SF6zXQe825cL0i3O9FjTod0gVVgjvc9uSU1HrQsSxcGSVRLAUrJA8NjruJPKs7ezi/pubhtml", icon: "fas fa-chart-pie", text: "186-Q-S-VIEW", category: "Analytics" },
      { id: "c16-qs-view", href: "https://docs.google.com/spreadsheets/d/e/2PACX-1vT1MRNcqWJsXyp4gKAq00N2qKmjoNgXkwVCmxH2lBeeitlz0kNfSiY-z1sNK2JTciPN6mzUpF9-G36Z/pubhtml", icon: "fas fa-chart-area", text: "C16-Q-S-VIEW", category: "Analytics" },
      { id: "projection-vs-sales", href: "https://docs.google.com/spreadsheets/d/1QzAuxxuLUz60iWbdiVGzAFDjXY0RSZIda_0VOhbloEU/edit", icon: "fas fa-bullseye", text: "Projection VS Sales Report", category: "Analytics" },
      { id: "projection-vs-actual", href: "https://docs.google.com/spreadsheets/d/1f7bODkOgwvN_i-nWItzn_67IZv0EqXxAqr2v-ZRQ8Vg/edit", icon: "fas fa-project-diagram", text: "PROJECTION VS ACTUAL", category: "Analytics" },
      { id: "sales-perf-ggn", href: "https://amitaadhya.github.io/Quincesaleggn/", icon: "fas fa-tachometer-alt", text: "Sales Perf. Dashboard-GGN", category: "Analytics" },
      { id: "sales-perf-noida", href: "https://amitaadhya.github.io/noidaquincesale/", icon: "fas fa-chart-bar", text: "NOIDA-Sales Perf. Dash.", category: "Analytics" },
      { id: "style-analyzer-ggn", href: "https://script.google.com/macros/s/AKfycbwMLk_TuKGtxzLFMxIoLVONqYMS5RRCf3cBqS9zDw/dev", icon: "fas fa-search-dollar", text: "Quince_ Style Analyzer_GGN", category: "Analytics" },
      { id: "style-analyzer-noida", href: "https://script.google.com/macros/s/AKfycbzljj_8OxdNR2AtJqxfTD_oB11YGTdF0MGulyLCvpE/dev", icon: "fas fa-search-location", text: "Quince_ Style Analyzer_NOIDA", category: "Analytics" },

      // === LOGISTICS TOOLS ===
      { id: "eway-bill", href: "https://192.168.20.7/vgeinvoice/LoginPage.aspx", icon: "fas fa-truck-fast", text: "E-Way Bill Dashboard", category: "Logistics" },
      { id: "maersk-stock-data", href: "https://docs.google.com/spreadsheets/d/1sehWq-1kvNwl0qZWOpkhapuk9mam0FjKAoJvHMV9U5o/edit", icon: "fas fa-ship", text: "MAERSK Stock Data", category: "Logistics" },
      { id: "c16-import-details", href: "https://docs.google.com/spreadsheets/d/1m3q0x9wKoM7Q7EBSCvpCTozbtB0-73xmgOO_Yx0EBAg/edit", icon: "fas fa-file-import", text: "C16-IMPORT DETAILS", category: "Logistics" },
      { id: "quince-shipping-data", href: "https://docs.google.com/spreadsheets/d/1EfFlN6kb_q08R3cWQT_LJfRoSCKvGpS_JkJGZaUMA34/edit", icon: "fas fa-globe-americas", text: "Quince Mexico & Canada Ship Data", category: "Logistics" },
      { id: "po-wise-qty", href: "https://docs.google.com/spreadsheets/d/1bQqiCaiQ_JGN_B-415ftvVgoH9MmaF9A4ydZkkYXS-Q/edit", icon: "fas fa-exchange-alt", text: "PO Wise Qty Send/Sale", category: "Logistics" },
      { id: "ggn-prep-2025", href: "https://docs.google.com/spreadsheets/d/1LZa3JvfEdt-9cdQkEmsEluwurMoDzmsXIyFWNpAcnfs/edit", icon: "fas fa-tasks", text: "GGN-PREPEMENT 2025", category: "Logistics" },

      // === OPERATIONS TOOLS ===
      { id: "quince-po-records", href: "https://docs.google.com/spreadsheets/d/1pcb48pdm_kwASlmRACu1_E3s1_DHcofF5uOx6h4mLXY/edit", icon: "fas fa-archive", text: "QUINCE PO RECORDS", category: "Operations" },
      { id: "ggn-quince-po-records", href: "https://docs.google.com/spreadsheets/d/1SA8SPgEQJzf-oCBDs6vbIcHdfau12cAoms5hsAANRAA/edit?gid=0#gid=0", icon: "fas fa-archive", text: "GGN QUINCE PO RECORDS", category: "Operations" },
      { id: "noida-quince-po-records", href: "https://docs.google.com/spreadsheets/d/1Gt6pzKGkboWUK-Ijbp5OeFjYuvq_JD22xip_D4cDYxg/edit?gid=0#gid=0", icon: "fas fa-archive", text: "NOIDA QUINCE PO RECORDS", category: "Operations" },

      // === INTERNATIONAL TOOLS ===
      { id: "quince-hk", href: "https://docs.google.com/spreadsheets/d/1l2CnQrl9YEfOFAoiqj82DYwJ-zQWYqCX5HuL87ffRlw/edit", icon: "fas fa-globe-asia", text: "Quince Hong Kong", category: "International" },

      // === PRODUCTIVITY TOOLS ===
      { id: "merge-pdf", href: "https://smallpdf.com/merge-pdf", icon: "fas fa-file-pdf", text: "Merge PDF", category: "Tools" },
      { id: "app-365", href: "https://www.office.com/apps/?auth=2", icon: "fab fa-microsoft", text: "Office 365 Apps", category: "Tools" },
      { id: "useful-websites", href: "https://www.notion.so/Welcome-to-Amit-Chaudhary-22a7a00d4f9780fe8865e67bf16d2430", icon: "fas fa-star", text: "Most Useful Websites (AKS!)", category: "Tools" },
      { id: "google-drive", href: "https://drive.google.com", icon: "fab fa-google-drive", text: "Google Drive", category: "Tools" },
      { id: "trello-board", href: "https://trello.com", icon: "fab fa-trello", text: "Trello Boards", category: "Tools" },
      { id: "slack-workspace", href: "https://slack.com", icon: "fab fa-slack", text: "Slack Workspace", category: "Tools" },
      { id: "zoom-meetings", href: "https://zoom.us", icon: "fas fa-video", text: "Zoom Meetings", category: "Tools" },
      { id: "calculator-online", href: "https://www.calculator.net", icon: "fas fa-calculator", text: "Online Calculator", category: "Tools" },
      { id: "time-tracker", href: "https://toggl.com", icon: "fas fa-clock", text: "Time Tracker", category: "Tools" },
      { id: "password-generator", href: "https://passwordsgenerator.net", icon: "fas fa-key", text: "Password Generator", category: "Tools" },
      { id: "qr-generator", href: "https://www.qr-code-generator.com", icon: "fas fa-qrcode", text: "QR Code Generator", category: "Tools" },
      { id: "color-picker", href: "https://htmlcolorcodes.com", icon: "fas fa-palette", text: "Color Picker", category: "Tools" },
      { id: "image-compressor", href: "https://tinypng.com", icon: "fas fa-compress", text: "Image Compressor", category: "Tools" },
      { id: "pdf-converter", href: "https://pdfcandy.com", icon: "fas fa-file-export", text: "PDF Converter", category: "Tools" },
      { id: "screen-recorder", href: "https://www.loom.com", icon: "fas fa-record-vinyl", text: "Screen Recorder", category: "Tools" },
      { id: "note-taking", href: "https://notion.so", icon: "fas fa-sticky-note", text: "Note Taking", category: "Tools" },
      { id: "task-manager", href: "https://todoist.com", icon: "fas fa-tasks", text: "Task Manager", category: "Tools" },
      { id: "file-converter", href: "https://convertio.co", icon: "fas fa-exchange-alt", text: "File Converter", category: "Tools" },
      { id: "website-screenshot", href: "https://screenshot.guru", icon: "fas fa-camera", text: "Website Screenshot", category: "Tools" },

      // === RESOURCE TOOLS ===
      { id: "anish-sir-site", href: "https://sites.google.com/view/bossanishji/", icon: "fas fa-user-tie", text: "Anish Sir's Site", category: "Resources" },
      { id: "amit-chaudhary-site", href: "https://sites.google.com/view/radnikaks/home", icon: "fas fa-user-astronaut", text: "Amit Chaudhary's Site", category: "Resources" }
    ];

    const QUICK_ACTIONS_DATA = [
      { id: "quick-calc", href: "https://www.calculator.net", icon: "fas fa-calculator", text: "Quick Calculator", desc: "Basic calculations" },
      { id: "quick-notes", href: "#", icon: "fas fa-sticky-note", text: "Quick Notes", desc: "Open notepad" },
      { id: "quick-scan", href: "https://www.qr-code-generator.com", icon: "fas fa-qrcode", text: "QR Generator", desc: "Create QR codes" },
      { id: "quick-convert", href: "https://pdfcandy.com", icon: "fas fa-file-export", text: "PDF Tools", desc: "PDF conversion" },
      { id: "quick-time", href: "https://toggl.com", icon: "fas fa-clock", text: "Time Tracker", desc: "Track work hours" },
      { id: "quick-password", href: "https://passwordsgenerator.net", icon: "fas fa-key", text: "Password Gen", desc: "Generate passwords" }
    ];

    const ANALYTICS_TOOLS_DATA = [
      { id: "sales-today", href: "#", icon: "fas fa-calendar-day", text: "Today's Sales", desc: "Real-time sales data" },
      { id: "sales-weekly", href: "#", icon: "fas fa-calendar-week", text: "Weekly Report", desc: "Weekly sales summary" },
      { id: "sales-monthly", href: "#", icon: "fas fa-calendar-alt", text: "Monthly Analytics", desc: "Monthly performance" },
      { id: "inventory-status", href: "#", icon: "fas fa-warehouse", text: "Inventory Status", desc: "Stock levels" },
      { id: "order-tracking", href: "#", icon: "fas fa-shipping-fast", text: "Order Tracking", desc: "Track shipments" },
      { id: "customer-analytics", href: "#", icon: "fas fa-users", text: "Customer Analytics", desc: "Customer insights" }
    ];
    
    // Utility Functions
    const getFromLocalStorage = (key, def) => {
      try { return JSON.parse(localStorage.getItem(key)) || def; } 
      catch { return def; }
    };
    const saveToLocalStorage = (key, data) => localStorage.setItem(key, JSON.stringify(data));
    const simpleHash = s => {
      if (!s) return "";
      let h = 0;
      for (let i = 0; i < s.length; i++) h = (h << 5) - h + s.charCodeAt(i) | 0;
      return "h_" + h.toString(36);
    };

    // DOM Elements
    const dom = {};
    
    // Initialize App
    document.addEventListener('DOMContentLoaded', () => {
      cacheDOMElements();
      initDefaultUsers();
      initEventListeners();
      loadTheme();
      updateClock();
      setInterval(updateClock, 1000);

      const savedUserJson = sessionStorage.getItem('currentUser');
      if (savedUserJson) {
        currentUser = JSON.parse(savedUserJson);
        showPortal();
      }

      setTimeout(() => dom.preloader.classList.add('hidden'), 800);
    });
    
    function cacheDOMElements() {
      const ids = ['preloader', 'loginContainer', 'portalView', 'loginBtn', 'username', 'password', 
        'errorMessage', 'sidebar', 'mainContent', 'menuToggle', 'logoutLink', 'welcomeMessage', 
        'userProfile', 'userNameText', 'userProfilePic', 'mainHeader', 'buttonContainer', 
        'myProfileBtnSidebar', 'notepadBtnSidebar', 'userManagementBtnSidebar', 'portalSettingsBtnSidebar', 
        'quickToolsBtnSidebar', 'analyticsBtnSidebar', 'quickToolsSection', 'analyticsSection',
        'userProfileModal', 'notepadModal', 'userManagementModal', 'portalSettingsModal', 
        'quickToolsModal', 'analyticsDashboardModal', 'saveNotepadBtn', 'notepadTextarea', 
        'createUserBtn', 'newUsername', 'newPassword', 'selectUserForPermissions', 
        'permissionsContainer', 'permissionsList', 'savePermissionsBtn', 'deleteUserBtn', 
        'userManagementMessage', 'searchInput', 'categoryFilter', 'overlay',
        'profileModalPic', 'profileModalName', 'profileModalRole', 'toolsCount', 'sessionTime',
        'snowToggleBtn'
      ];
      ids.forEach(id => dom[id] = document.getElementById(id));
      dom.closeBtns = document.querySelectorAll('.close-btn');
    }

    function initEventListeners() {
      dom.loginBtn.addEventListener('click', validateLogin);
      dom.password.addEventListener('keypress', e => { if (e.key === 'Enter') validateLogin(); });
      dom.username.addEventListener('keypress', e => { if (e.key === 'Enter') dom.password.focus(); });
      dom.logoutLink.addEventListener('click', logout);
      
      dom.menuToggle.addEventListener('click', toggleSidebar);
      dom.overlay.addEventListener('click', closeSidebar);
      
      dom.searchInput.addEventListener('input', filterButtons);
      dom.categoryFilter.addEventListener('change', filterButtons);
      
      dom.myProfileBtnSidebar.addEventListener('click', () => { openProfileModal(); closeSidebar(); });
      dom.notepadBtnSidebar.addEventListener('click', () => { openNotepad(); closeSidebar(); });
      dom.userManagementBtnSidebar.addEventListener('click', () => { openUserManagement(); closeSidebar(); });
      dom.portalSettingsBtnSidebar.addEventListener('click', () => { openModal('portalSettingsModal'); closeSidebar(); });
      dom.quickToolsBtnSidebar.addEventListener('click', () => { openQuickTools(); closeSidebar(); });
      dom.analyticsBtnSidebar.addEventListener('click', () => { openAnalytics(); closeSidebar(); });
      
      dom.snowToggleBtn.addEventListener('click', toggleSnowEffect);

      dom.closeBtns.forEach(btn => btn.addEventListener('click', (e) => e.target.closest('.modal').style.display = 'none'));
      
      document.querySelectorAll('.modal').forEach(modal => {
        modal.addEventListener('click', (e) => {
          if (e.target === modal) modal.style.display = 'none';
        });
      });
      
      dom.saveNotepadBtn.addEventListener('click', saveNotepad);
      dom.createUserBtn.addEventListener('click', createUser);
      dom.selectUserForPermissions.addEventListener('change', loadPermissionsForUser);
      dom.savePermissionsBtn.addEventListener('click', savePermissions);
      dom.deleteUserBtn.addEventListener('click', deleteUser);

      // Enhanced Event Listeners
      document.addEventListener('mousemove', handleMagicBackground);
      document.querySelectorAll('.swatch').forEach(swatch => {
          swatch.addEventListener('click', changeTheme);
      });
    }
    
    function toggleSidebar() {
      dom.sidebar.classList.toggle('open');
      dom.overlay.classList.toggle('active');
    }
    
    function closeSidebar() {
      dom.sidebar.classList.remove('open');
      dom.overlay.classList.remove('active');
    }
    
    function validateLogin() {
      const username = dom.username.value.trim();
      const password = dom.password.value.trim();
      
      if (!username || !password) {
        showLoginMessage('Please enter credentials.');
        return;
      }

      const users = getFromLocalStorage(USERS_KEY, []);
      const user = users.find(u => 
        u.username.toLowerCase() === username.toLowerCase() && 
        u.password === simpleHash(password)
      );

      if (user) {
        currentUser = user;
        sessionStorage.setItem('currentUser', JSON.stringify(user));
        sessionStartTime = Date.now();
        showPortal();
      } else {
        showLoginMessage('Access Denied. Invalid credentials.');
      }
    }
    
    function logout() {
      currentUser = null;
      sessionStorage.removeItem('currentUser');
      dom.portalView.classList.remove('visible');
      dom.loginContainer.classList.remove('hidden');
      closeSidebar();
      dom.username.value = '';
      dom.password.value = '';
    }

    function showPortal() {
      if (!currentUser) return;
      dom.loginContainer.classList.add('hidden');
      dom.portalView.classList.add('visible');
      
      animateWelcomeMessage(`Welcome back, ${currentUser.username}!`);
      dom.userNameText.textContent = currentUser.username;
      dom.userProfilePic.src = currentUser.profilePicUrl;
      dom.userProfile.style.display = 'flex';
      
      const isAdmin = currentUser.username.toLowerCase() === 'admin';
      document.querySelectorAll('.admin-only').forEach(el => {
        el.style.display = isAdmin ? 'block' : 'none';
      });
      
      populateButtons();
      populateQuickActions();
      populateAnalyticsTools();
    }
    
    function showLoginMessage(msg) {
      dom.errorMessage.textContent = msg;
      dom.errorMessage.style.display = 'block';
      setTimeout(() => { dom.errorMessage.style.display = 'none'; }, 3000);
    }
    
    function updateClock() {
      const clockEl = document.getElementById('clock');
      if (clockEl) {
        clockEl.textContent = new Date().toLocaleTimeString('en-US', { 
          hour: '2-digit', 
          minute: '2-digit',
          second: '2-digit'
        });
      }
    }
    
    function populateButtons() {
      dom.buttonContainer.innerHTML = '';
      const userPermissions = getFromLocalStorage(PERMISSIONS_KEY, {})[currentUser.username] || [];
      const isAdmin = currentUser.username.toLowerCase() === 'admin';
      
      allButtons = isAdmin ? ALL_BUTTONS_DATA : ALL_BUTTONS_DATA.filter(btn => userPermissions.includes(btn.id));
      filteredButtons = [...allButtons];
      
      const categories = [...new Set(allButtons.map(btn => btn.category))].sort();
      dom.categoryFilter.innerHTML = '<option value="all">All Categories</option>';
      categories.forEach(category => {
        const option = document.createElement('option');
        option.value = category;
        option.textContent = category;
        dom.categoryFilter.appendChild(option);
      });
      
      renderButtons();
    }

    function populateQuickActions() {
      const quickActionsList = document.getElementById('quickActionsList');
      const favoritesList = document.getElementById('favoritesList');
      
      quickActionsList.innerHTML = '';
      QUICK_ACTIONS_DATA.forEach(action => {
        const item = createListItem(action);
        quickActionsList.appendChild(item);
      });

      favoritesList.innerHTML = '';
      const favorites = getFromLocalStorage(FAVORITES_KEY, {})[currentUser.username] || [];
      const favoriteItems = ALL_BUTTONS_DATA.filter(btn => favorites.includes(btn.id));
      
      if (favoriteItems.length === 0) {
        favoritesList.innerHTML = '<div class="no-results" style="padding: 20px;"><i class="fas fa-star"></i><p>No favorites added yet</p></div>';
      } else {
        favoriteItems.forEach(item => {
          const listItem = createListItem({
            id: item.id,
            href: item.href,
            icon: item.icon,
            text: item.text,
            desc: item.category
          });
          favoritesList.appendChild(listItem);
        });
      }
    }

    function populateAnalyticsTools() {
      const salesAnalyticsList = document.getElementById('salesAnalyticsList');
      const performanceMetricsList = document.getElementById('performanceMetricsList');
      
      salesAnalyticsList.innerHTML = '';
      ANALYTICS_TOOLS_DATA.slice(0, 3).forEach(tool => {
        const item = createListItem(tool);
        salesAnalyticsList.appendChild(item);
      });

      performanceMetricsList.innerHTML = '';
      ANALYTICS_TOOLS_DATA.slice(3).forEach(tool => {
        const item = createListItem(tool);
        performanceMetricsList.appendChild(item);
      });
    }

    function createListItem(data) {
      const div = document.createElement('a');
      div.href = data.href;
      div.className = 'list-item';
      if (data.href === '#') {
        div.addEventListener('click', (e) => {
          e.preventDefault();
          handleQuickAction(data.id);
        });
      } else {
        div.target = '_blank';
        div.rel = 'noopener noreferrer';
      }
      
      div.innerHTML = `
        <div class="list-item-icon">
          <i class="${data.icon}"></i>
        </div>
        <div class="list-item-content">
          <div class="list-item-title">${data.text}</div>
          <div class="list-item-desc">${data.desc}</div>
        </div>
        <i class="fas fa-external-link-alt" style="color: var(--text-muted); font-size: 0.8rem;"></i>
      `;
      return div;
    }

    function handleQuickAction(actionId) {
      if(actionId === 'quick-notes') openNotepad();
      else if(actionId === 'quick-calc') window.open('https://www.calculator.net', '_blank');
      else alert(`Action: ${actionId} - Premium feature coming soon!`);
    }
    
    function renderButtons() {
      dom.buttonContainer.innerHTML = '';
      
      if (filteredButtons.length === 0) {
        dom.buttonContainer.innerHTML = `
          <div class="no-results">
            <i class="fas fa-search"></i>
            <p>No premium tools found matching your criteria.</p>
          </div>`;
        return;
      }
      
      filteredButtons.forEach((btnData, index) => {
        const btnElement = document.createElement('a');
        btnElement.href = btnData.href;
        btnElement.className = 'tool-card';
        btnElement.target = '_blank';
        btnElement.rel = 'noopener noreferrer';
        btnElement.style.animation = `cardFadeIn 0.5s ease-out forwards ${index * 0.05}s`;
        btnElement.style.opacity = '0';
        
        btnElement.innerHTML = `
          <div class="icon-box"><i class="${btnData.icon}"></i></div>
          <div class="card-text">
            <h3>${btnData.text}</h3>
            <p>${btnData.category}</p>
          </div>
          <i class="fas fa-arrow-right arrow-icon"></i>
        `;
        dom.buttonContainer.appendChild(btnElement);
      });
      
      // Initialize 3D tilt effect
      init3DTiltEffect();
    }

    function filterButtons() {
      const searchTerm = dom.searchInput.value.toLowerCase();
      const selectedCategory = dom.categoryFilter.value;
      
      filteredButtons = allButtons.filter(btn => {
        const matchesSearch = btn.text.toLowerCase().includes(searchTerm) || 
                             btn.category.toLowerCase().includes(searchTerm);
        const matchesCategory = selectedCategory === 'all' || btn.category === selectedCategory;
        return matchesSearch && matchesCategory;
      });
      
      renderButtons();
    }

    function openModal(modalId) { document.getElementById(modalId).style.display = 'block'; }
    function showUserManagementMessage(msg, type = 'success') {
      dom.userManagementMessage.textContent = msg;
      dom.userManagementMessage.className = 'message-box ' + type;
      dom.userManagementMessage.style.display = 'block';
      setTimeout(() => dom.userManagementMessage.style.display = 'none', 3000);
    }
    
    function openProfileModal() {
      dom.profileModalPic.src = currentUser.profilePicUrl;
      dom.profileModalName.textContent = currentUser.username;
      dom.profileModalRole.textContent = currentUser.username.toLowerCase() === 'admin' ? 'Administrator' : 'Premium Member';
      dom.toolsCount.textContent = allButtons.length;
      dom.sessionTime.textContent = Math.floor((Date.now() - sessionStartTime) / 60000);
      openModal('userProfileModal');
    }
    
    function openNotepad() {
      dom.notepadTextarea.value = getFromLocalStorage('notepad_' + currentUser.username, '');
      openModal('notepadModal');
    }
    function openQuickTools() { populateQuickActions(); openModal('quickToolsModal'); }
    function openAnalytics() { populateAnalyticsTools(); openModal('analyticsDashboardModal'); }
    
    function saveNotepad() {
      saveToLocalStorage('notepad_' + currentUser.username, dom.notepadTextarea.value);
      dom.notepadModal.style.display = 'none';
      alert('Premium notes saved successfully!');
    }

    function openUserManagement() {
      populateUsersDropdown();
      dom.permissionsContainer.style.display = 'none';
      dom.newUsername.value = '';
      dom.newPassword.value = '';
      openModal('userManagementModal');
    }
    
    function populateUsersDropdown() {
      const users = getFromLocalStorage(USERS_KEY, []);
      dom.selectUserForPermissions.innerHTML = '<option value="">-- Select User --</option>';
      users.filter(u => u.username.toLowerCase() !== 'admin').forEach(u => {
        const option = new Option(u.username, u.username);
        dom.selectUserForPermissions.add(option);
      });
    }
    
    function createUser() {
      const username = dom.newUsername.value.trim();
      const password = dom.newPassword.value.trim();
      if (!username || !password) { showUserManagementMessage('Please fill in all fields.', 'error'); return; }
      if (username.length < 3) { showUserManagementMessage('Username must be at least 3 characters.', 'error'); return; }
      let users = getFromLocalStorage(USERS_KEY, []);
      if (users.some(u => u.username.toLowerCase() === username.toLowerCase())) { showUserManagementMessage('Username already exists.', 'error'); return; }
      users.push({ username, password: simpleHash(password), profilePicUrl: 'https://i.pravatar.cc/150?u=' + username });
      saveToLocalStorage(USERS_KEY, users);
      showUserManagementMessage('Premium user created successfully!', 'success');
      dom.newUsername.value = ''; dom.newPassword.value = '';
      populateUsersDropdown();
    }
    
    function loadPermissionsForUser() {
      const username = dom.selectUserForPermissions.value;
      dom.deleteUserBtn.disabled = !username;
      if (!username) { dom.permissionsContainer.style.display = 'none'; return; }
      const userPermissions = getFromLocalStorage(PERMISSIONS_KEY, {})[username] || [];
      dom.permissionsList.innerHTML = '';
      ALL_BUTTONS_DATA.forEach(btn => {
        const isChecked = userPermissions.includes(btn.id);
        const div = document.createElement('div');
        div.className = 'permission-item';
        div.innerHTML = `<input type="checkbox" id="perm-${btn.id}" value="${btn.id}" ${isChecked ? 'checked' : ''}><label for="perm-${btn.id}">${btn.text}</label>`;
        dom.permissionsList.appendChild(div);
      });
      dom.permissionsContainer.style.display = 'block';
    }
    
    function savePermissions() {
      const username = dom.selectUserForPermissions.value;
      if (!username) return;
      let allPermissions = getFromLocalStorage(PERMISSIONS_KEY, {});
      allPermissions[username] = Array.from(dom.permissionsList.querySelectorAll('input:checked')).map(input => input.value);
      saveToLocalStorage(PERMISSIONS_KEY, allPermissions);
      showUserManagementMessage('Premium permissions saved successfully!', 'success');
    }
    
    function deleteUser() {
      const username = dom.selectUserForPermissions.value;
      if (!username || !confirm(`Are you sure you want to delete premium user "${username}"?`)) return;
      saveToLocalStorage(USERS_KEY, getFromLocalStorage(USERS_KEY, []).filter(u => u.username !== username));
      let allPermissions = getFromLocalStorage(PERMISSIONS_KEY, {});
      delete allPermissions[username];
      saveToLocalStorage(PERMISSIONS_KEY, allPermissions);
      showUserManagementMessage('Premium user deleted successfully!', 'success');
      populateUsersDropdown();
      dom.permissionsContainer.style.display = 'none';
    }

    function initDefaultUsers() {
      let users = getFromLocalStorage(USERS_KEY, []);
      const defaultPic = 'https://i.postimg.cc/sXPJH9xd/Screenshot-2025-06-19-143219.png';
      const ensureUser = (username, password) => {
        if (!users.some(u => u.username.toLowerCase() === username.toLowerCase())) {
          users.push({ username, password: simpleHash(password), profilePicUrl: defaultPic });
        }
      };
      ensureUser('admin', 'aminehu@123');
      ensureUser('amit', 'aminehu@123');
      saveToLocalStorage(USERS_KEY, users);
    }
    
    let isSnowing = false;
    function toggleSnowEffect() {
      isSnowing = !isSnowing;
      const snowBtn = document.getElementById('snowToggleBtn');
      if (isSnowing) {
        createSnowfall();
        snowBtn.classList.add('active');
        snowBtn.innerHTML = '<i class="fas fa-snowflake"></i> Stop Snow';
      } else {
        const snowContainer = document.getElementById('snow-container');
        if (snowContainer) snowContainer.remove();
        snowBtn.classList.remove('active');
        snowBtn.innerHTML = '<i class="fas fa-snowflake"></i> Let It Snow';
      }
      closeSidebar();
    }

    function createSnowfall() {
      const snowContainer = document.createElement('div');
      snowContainer.id = 'snow-container';
      document.body.appendChild(snowContainer);
      for (let i = 0; i < 200; i++) {
        const flake = document.createElement('div');
        flake.className = 'snowflake';
        const size = Math.random() * 6 + 2 + 'px';
        flake.style.width = size;
        flake.style.height = size;
        flake.style.left = Math.random() * 100 + 'vw';
        flake.style.animationDuration = Math.random() * 10 + 5 + 's';
        flake.style.animationDelay = Math.random() * 10 + 's';
        flake.style.opacity = Math.random();
        snowContainer.appendChild(flake);
      }
    }
    
    // Premium Enhanced Functions
    
    function animateWelcomeMessage(text) {
        const welcomeEl = document.getElementById('welcomeMessage');
        welcomeEl.textContent = '';
        let i = 0;
        const interval = setInterval(() => {
            if (i < text.length) {
                welcomeEl.textContent += text.charAt(i);
                i++;
            } else {
                clearInterval(interval);
            }
        }, 50);
    }

    function handleMagicBackground(e) {
        const glow = document.getElementById('background-glow');
        if(glow) {
            glow.style.setProperty('--mouse-x', e.clientX + 'px');
            glow.style.setProperty('--mouse-y', e.clientY + 'px');
        }
    }
    
    function init3DTiltEffect() {
        const cards = document.querySelectorAll('.tool-card');
        cards.forEach(card => {
            card.addEventListener('mousemove', e => {
                const rect = card.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                const { width, height } = rect;
                const rotateX = (y / height - 0.5) * -20;
                const rotateY = (x / width - 0.5) * 20;
                card.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) scale(1.05) translateY(-10px)`;
            });
            card.addEventListener('mouseleave', () => {
                card.style.transform = 'rotateX(0) rotateY(0) scale(1) translateY(0)';
            });
        });
    }
    
    function changeTheme(e) {
        const selectedTheme = e.target.dataset.theme;
        document.body.setAttribute('data-theme', selectedTheme);
        localStorage.setItem(THEME_KEY, selectedTheme);

        document.querySelectorAll('.swatch').forEach(s => s.classList.remove('active'));
        e.target.classList.add('active');
    }

    function loadTheme() {
        const savedTheme = localStorage.getItem(THEME_KEY) || 'blue';
        document.body.setAttribute('data-theme', savedTheme);
        document.querySelectorAll('.swatch').forEach(s => {
            s.classList.toggle('active', s.dataset.theme === savedTheme);
        });
    }

  </script>
</body>
</html>
